import{e as M,_ as N}from"./index-DHbBoFFL.js";import{b as O,c as L}from"./index-D_cyDMPT.js";import{g as P}from"./index-Fy_YmPVJ.js";import{E as p}from"./element-WTle-ZkF.js";import{l as j,e as w,r as c,d as z,ah as o,ap as G,m as s,p as _,P as H,M as x,O as n,U as a,F as J,a7 as K,q as S,S as Q,aE as R,aF as W}from"./vue-DSQ7aDT9.js";import"./vxe-CH38uc_I.js";const X=d=>(R("data-v-c4d65123"),d=d(),W(),d),Y={class:"app-container"},Z={key:0,style:{"margin-bottom":"20px"}},$={key:1,style:{"margin-bottom":"20px"}},ee={class:"form-tip"},te=X(()=>S("span",null,'匹配规则：邮箱域名必须与配置完全一致。例如：输入 "gmail.com" 只允许 @gmail.com 注册，不允许 @gmail.cc 注册。',-1)),ae=j({__name:"other",setup(d){const f=M(),m=w(()=>f.isSuperAdmin),I=w(()=>f.tenantId),u=c(!1),g=c([]),i=c(void 0),r=c({email_limit:""}),V=c(null);z(async()=>{if(u.value=!0,m.value)try{const e=await P({page:1,limit:100});e.data&&e.data.data&&(g.value=e.data.data)}catch(e){console.error("加载租户列表失败:",e)}await v(),u.value=!1});const v=async()=>{try{const e=m.value?i.value:I.value,t=await O(e??void 0);t.data&&(r.value=t.data)}catch(e){console.error("加载配置失败:",e),p.error("加载配置失败")}},k=async()=>{await v()};async function F(){try{const e={...r.value};m.value&&i.value&&(e.tenant_id=i.value);const t=await L(e);t.code===200?(p.success(t.message||"配置保存成功"),await v()):p.error(t.message||"保存失败")}catch(e){console.error("保存失败:",e),p.error("保存失败")}}return(e,t)=>{const h=o("el-alert"),y=o("el-option"),C=o("el-select"),D=o("el-input"),T=o("InfoFilled"),B=o("el-icon"),b=o("el-form-item"),E=o("el-button"),U=o("el-form"),q=o("el-card"),A=G("loading");return s(),_("div",Y,[H((s(),x(q,{shadow:"never","element-loading-text":"加载中..."},{default:n(()=>[m.value?(s(),_("div",Z,[a(h,{type:"info",title:"全局配置",description:"请选择租户来查看或编辑其配置。不选择租户则查看/编辑全局默认配置。",closable:!1,"show-icon":""}),a(C,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),placeholder:"选择租户（不选择则为全局配置）",clearable:"",onChange:k,style:{width:"300px","margin-top":"10px"}},{default:n(()=>[a(y,{label:"全局配置",value:void 0}),(s(!0),_(J,null,K(g.value,l=>(s(),x(y,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):(s(),_("div",$,[a(h,{type:"warning",title:"租户配置",description:"此为租户级别配置，仅对本租户生效。如未配置，将使用全局配置。",closable:!1,"show-icon":""})])),a(U,{class:"settingForm",ref_key:"settingForm",ref:V,model:r.value,"label-position":"top"},{default:n(()=>[a(b,{label:"限定注册邮箱后缀",prop:"email_limit"},{default:n(()=>[a(D,{modelValue:r.value.email_limit,"onUpdate:modelValue":t[1]||(t[1]=l=>r.value.email_limit=l),placeholder:"请输入允许的邮箱域名，多个用逗号隔开，如: gmail.com,qq.com,163.com",clearable:""},null,8,["modelValue"]),S("div",ee,[a(B,null,{default:n(()=>[a(T)]),_:1}),te])]),_:1}),a(b,{class:"setting-btns"},{default:n(()=>[a(E,{style:{width:"88px"},type:"primary",onClick:F},{default:n(()=>[Q("保存其他设置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["element-loading-text"])),[[A,u.value]])])}}}),ce=N(ae,[["__scopeId","data-v-c4d65123"]]);export{ce as default};
