import{u as ae,c as le,d as te,g as oe}from"./index-BZ8yLXHZ.js";import{t as V,v as ne,w as se,x as ue,B as re,y as de,E as A,A as ie}from"./element-WTle-ZkF.js";import{u as ce}from"./usePagination-DRno2DY3.js";import{l as pe,r as v,e as E,Z as _e,b as me,ah as s,ap as fe,m as w,p as ge,P as ve,M as S,O as a,U as e,u as r,S as i,q as p,T as x,aE as he,aF as ye}from"./vue-DSQ7aDT9.js";import{_ as be}from"./index-wPdwrGlV.js";import"./vxe-CH38uc_I.js";const Ve=y=>(he("data-v-b033cc61"),y=y(),ye(),y),we={class:"app-container"},xe={class:"table-wrapper"},Ce={style:{color:"#409eff"}},ke={style:{color:"#67c23a"}},Be={class:"pager-wrapper"},Se={class:"dialog_head"},ze={class:"title"},De=Ve(()=>p("span",{class:"ml-2"},"GB",-1)),Ue={class:"btn_box"},Te=pe({name:"TenantManagement",__name:"index",setup(y){const _=v(!1),{paginationData:u,handleCurrentChange:G,handleSizeChange:M}=ce(),C={id:void 0,tenant_code:"",name:"",company_name:"",contact_person:"",status:"active",storage_quota:10737418240,max_users:100},g=v(!1),k=v(null),t=v(V(C)),R=E(()=>({tenant_code:[{required:!0,trigger:"blur",message:"请输入租户代码"}],name:[{required:!0,trigger:"blur",message:"请输入租户名称"}],company_name:[{required:!0,trigger:"blur",message:"请输入公司名称"}]})),I=()=>{var n;(n=k.value)==null||n.validate((o,m)=>{if(!o)return console.error("表单校验不通过",m);_.value=!0,(t.value.id?ae(t.value.id,t.value):le(t.value)).then(()=>{A.success("操作成功"),g.value=!1,b()}).catch(()=>{}).finally(()=>{_.value=!1})})},z=()=>{var n;(n=k.value)==null||n.clearValidate(),t.value=V(C),g.value=!1},N=()=>{t.value=V(C),g.value=!0},O=n=>{t.value=V(n),g.value=!0},D=E({get:()=>Math.floor((t.value.storage_quota||0)/(1024*1024*1024)),set:n=>{t.value.storage_quota=n*1024*1024*1024}}),$=n=>{ie.confirm(`确定要删除租户"${n.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.value=!0,te(n.id).then(()=>{A.success("删除成功"),b()}).finally(()=>{_.value=!1})}).catch(()=>{})},B=v([]),L=v(null),h=_e({keyword:""}),b=()=>{_.value=!0,oe({page:u.currentPage,limit:u.pageSize,keyword:h.keyword||void 0}).then(({data:n})=>{u.total=n.total,B.value=n.data}).catch(()=>{B.value=[]}).finally(()=>{_.value=!1})},U=()=>{u.currentPage===1?b():u.currentPage=1},Q=()=>{h.keyword="",U()};return me([()=>u.currentPage,()=>u.pageSize],b,{immediate:!0}),(n,o)=>{const m=s("el-input"),d=s("el-form-item"),f=s("el-button"),T=s("el-form"),c=s("el-table-column"),q=s("el-tag"),Z=s("el-table"),j=s("el-pagination"),H=s("el-card"),J=s("Close"),K=s("el-icon"),F=s("el-option"),W=s("el-select"),P=s("el-input-number"),X=s("el-dialog"),Y=fe("loading");return w(),ge("div",we,[ve((w(),S(H,{shadow:"never"},{default:a(()=>[e(T,{ref_key:"searchFormRef",ref:L,inline:!0,model:h},{default:a(()=>[e(d,{prop:"keyword",label:"",style:{width:"320px","max-width":"100%"}},{default:a(()=>[e(m,{modelValue:h.keyword,"onUpdate:modelValue":o[0]||(o[0]=l=>h.keyword=l),placeholder:"输入查询"},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(f,{type:"primary",icon:r(ne),onClick:U},{default:a(()=>[i("查询")]),_:1},8,["icon"]),e(f,{icon:r(se),onClick:Q},{default:a(()=>[i("重置")]),_:1},8,["icon"])]),_:1}),e(d,null,{default:a(()=>[e(f,{type:"primary",icon:r(ue),onClick:N},{default:a(()=>[i("新增租户")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),p("div",xe,[e(Z,{data:B.value},{default:a(()=>[e(c,{prop:"id",label:"租户ID",align:"left",width:"80"}),e(c,{prop:"tenant_code",label:"租户代码",align:"left"}),e(c,{prop:"name",label:"租户名称",align:"left"}),e(c,{prop:"company_name",label:"公司名称",align:"left"}),e(c,{prop:"contact_person",label:"联系人",align:"left"}),e(c,{prop:"status",label:"状态",align:"left",width:"100"},{default:a(l=>[l.row.status==="active"?(w(),S(q,{key:0,type:"success",effect:"plain"},{default:a(()=>[i("启用")]),_:1})):(w(),S(q,{key:1,type:"danger",effect:"plain"},{default:a(()=>[i("禁用")]),_:1}))]),_:1}),e(c,{prop:"storage_quota",label:"存储配额",align:"left"},{default:a(({row:l})=>[i(x((l.storage_quota/(1024*1024*1024)).toFixed(2))+" GB ",1)]),_:1}),e(c,{label:"已分配/剩余",align:"left",width:"180"},{default:a(({row:l})=>[p("div",null,[p("span",Ce,x((l.total_storage/(1024*1024*1024)).toFixed(2))+"GB",1),i(" / "),p("span",ke,x(((l.storage_quota-l.total_storage)/(1024*1024*1024)).toFixed(2))+"GB",1)])]),_:1}),e(c,{prop:"max_users",label:"最大用户数",align:"left"}),e(c,{fixed:"right",label:"操作",width:"120",align:"left"},{default:a(l=>[e(f,{type:"primary",text:"",size:"small",icon:r(re),onClick:ee=>O(l.row)},{default:a(()=>[i("编辑")]),_:2},1032,["icon","onClick"]),e(f,{type:"danger",text:"",size:"small",icon:r(de),onClick:ee=>$(l.row)},{default:a(()=>[i("删除")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),p("div",Be,[e(j,{background:"",layout:r(u).layout,"page-sizes":r(u).pageSizes,total:r(u).total,"page-size":r(u).pageSize,currentPage:r(u).currentPage,onSizeChange:r(M),onCurrentChange:r(G)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[Y,_.value]]),e(X,{"modal-class":"custom_dialog",modelValue:g.value,"onUpdate:modelValue":o[8]||(o[8]=l=>g.value=l),"show-close":!1},{header:a(()=>[p("div",Se,[p("div",ze,x(t.value.id===void 0?"新增租户":"编辑租户信息"),1),e(K,{onClick:z},{default:a(()=>[e(J)]),_:1})])]),default:a(()=>[e(T,{ref_key:"formRef",ref:k,model:t.value,rules:R.value,"label-width":"150px","label-position":"left"},{default:a(()=>[e(d,{prop:"tenant_code",label:"租户代码"},{default:a(()=>[e(m,{modelValue:t.value.tenant_code,"onUpdate:modelValue":o[1]||(o[1]=l=>t.value.tenant_code=l),placeholder:"请输入租户代码（唯一，用于区分租户）"},null,8,["modelValue"])]),_:1}),e(d,{prop:"name",label:"租户名称"},{default:a(()=>[e(m,{modelValue:t.value.name,"onUpdate:modelValue":o[2]||(o[2]=l=>t.value.name=l),placeholder:"请输入租户名称"},null,8,["modelValue"])]),_:1}),e(d,{prop:"company_name",label:"公司名称"},{default:a(()=>[e(m,{modelValue:t.value.company_name,"onUpdate:modelValue":o[3]||(o[3]=l=>t.value.company_name=l),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1}),e(d,{prop:"contact_person",label:"联系人"},{default:a(()=>[e(m,{modelValue:t.value.contact_person,"onUpdate:modelValue":o[4]||(o[4]=l=>t.value.contact_person=l),placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1}),e(d,{prop:"status",label:"状态"},{default:a(()=>[e(W,{modelValue:t.value.status,"onUpdate:modelValue":o[5]||(o[5]=l=>t.value.status=l),placeholder:"请选择状态"},{default:a(()=>[e(F,{label:"启用",value:"active"}),e(F,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(d,{prop:"storage_quota",label:"存储配额(GB)"},{default:a(()=>[e(P,{style:{width:"80%"},precision:0,modelValue:D.value,"onUpdate:modelValue":o[6]||(o[6]=l=>D.value=l),step:1,min:1,placeholder:"请输入存储配额"},null,8,["modelValue"]),De]),_:1}),e(d,{prop:"max_users",label:"最大用户数"},{default:a(()=>[e(P,{style:{width:"80%"},precision:0,modelValue:t.value.max_users,"onUpdate:modelValue":o[7]||(o[7]=l=>t.value.max_users=l),step:10,min:1,placeholder:"请输入最大用户数"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),p("div",Ue,[e(f,{onClick:z},{default:a(()=>[i("取消")]),_:1}),e(f,{type:"primary",onClick:I,loading:_.value},{default:a(()=>[i("确认")]),_:1},8,["loading"])])]),_:1},8,["modelValue"])])}}}),Me=be(Te,[["__scopeId","data-v-b033cc61"]]);export{Me as default};
