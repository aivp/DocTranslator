import{e as F,_ as z}from"./index-D1ZkKF0s.js";import{a as M,s as N}from"./index-DAF68Mim.js";import{g as L}from"./index-lQZTb92S.js";import{E as k}from"./element-WTle-ZkF.js";import{l as q,e as S,r as _,d as O,ah as s,ap as j,m as i,p as u,P as G,M as I,O as n,U as o,F as H,a7 as J,S as K,aE as Q,aF as R,q as g}from"./vue-DSQ7aDT9.js";import"./vxe-CH38uc_I.js";const h=d=>(Q("data-v-ffe902bc"),d=d(),R(),d),W={class:"app-container"},X={key:0,style:{"margin-bottom":"20px"}},Y={key:1,style:{"margin-bottom":"20px"}},Z=h(()=>g("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 用于文本翻译功能的 API 密钥 ",-1)),$=h(()=>g("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 用于视频翻译功能的 Client ID ",-1)),ee=h(()=>g("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 用于视频翻译功能的 Client Secret ",-1)),te=q({name:"接口配置",__name:"api",setup(d){const y=F(),r=S(()=>y.isSuperAdmin),V=S(()=>y.tenantId),m=_(!1),b=_([]),c=_(void 0),a=_({dashscope_key:"",akool_client_id:"",akool_client_secret:""}),A={};O(async()=>{if(m.value=!0,r.value)try{const t=await L({page:1,limit:100});t.data&&t.data.data&&(b.value=t.data.data)}catch(t){console.error("加载租户列表失败:",t)}await v(),m.value=!1});const v=async()=>{try{const t=r.value?c.value:V.value??void 0,e=await M(t);e.data&&(a.value={dashscope_key:e.data.dashscope_key||"",akool_client_id:e.data.akool_client_id||"",akool_client_secret:e.data.akool_client_secret||""})}catch(t){console.error("加载配置失败:",t)}},C=async()=>{await v()};function D(){const t={dashscope_key:a.value.dashscope_key,akool_client_id:a.value.akool_client_id,akool_client_secret:a.value.akool_client_secret};r.value&&c.value&&(t.tenant_id=c.value),N(t).then(e=>{e.code==200?(k.success(e.message||"保存成功"),v()):k.error(e.message||"保存失败")}).catch(e=>{k.error(e.message||"保存失败")})}return(t,e)=>{const w=s("el-alert"),x=s("el-option"),U=s("el-select"),f=s("el-input"),p=s("el-form-item"),P=s("el-button"),T=s("el-form"),B=s("el-card"),E=j("loading");return i(),u("div",W,[G((i(),I(B,{shadow:"never","element-loading-text":"加载中..."},{default:n(()=>[r.value?(i(),u("div",X,[o(w,{type:"info",title:"全局配置",description:"请选择租户来查看或编辑其配置。不选择租户则查看/编辑全局默认配置。",closable:!1,"show-icon":""}),o(U,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),placeholder:"选择租户（不选择则为全局配置）",clearable:"",onChange:C,style:{width:"300px","margin-top":"10px"}},{default:n(()=>[o(x,{label:"全局配置",value:void 0}),(i(!0),u(H,null,J(b.value,l=>(i(),I(x,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):(i(),u("div",Y,[o(w,{type:"warning",title:"租户配置",description:"此为租户级别配置，仅对本租户生效。如未配置，将使用全局配置。",closable:!1,"show-icon":""})])),o(T,{class:"settingForm",model:a.value,"label-position":"top",rules:A},{default:n(()=>[o(p,{label:"阿里云 DashScope API 密钥"},{default:n(()=>[o(f,{modelValue:a.value.dashscope_key,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.dashscope_key=l),type:"password","show-password":"",placeholder:"请输入阿里云 DashScope API 密钥"},null,8,["modelValue"]),Z]),_:1}),o(p,{label:"Akool Client ID"},{default:n(()=>[o(f,{modelValue:a.value.akool_client_id,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.akool_client_id=l),placeholder:"请输入 Akool Client ID"},null,8,["modelValue"]),$]),_:1}),o(p,{label:"Akool Client Secret"},{default:n(()=>[o(f,{modelValue:a.value.akool_client_secret,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.akool_client_secret=l),type:"password","show-password":"",placeholder:"请输入 Akool Client Secret"},null,8,["modelValue"]),ee]),_:1}),o(p,{class:"setting-btns"},{default:n(()=>[o(P,{type:"primary",onClick:D},{default:n(()=>[K("保存API设置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["element-loading-text"])),[[E,m.value]])])}}}),ce=z(te,[["__scopeId","data-v-ffe902bc"]]);export{ce as default};
