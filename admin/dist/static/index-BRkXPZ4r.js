import{r as w,aD as E,Z as k,ah as p,m as S,p as U,U as e,O as a,u,S as g,aE as q,aF as I,q as m}from"./vue-DSQ7aDT9.js";import{r as R,C as B,D as v,E as f}from"./element-WTle-ZkF.js";import{_ as D,h as N}from"./index-DHbBoFFL.js";import"./vxe-CH38uc_I.js";const P=i=>(q("data-v-b4e3190c"),i=i(),I(),i),F={class:"security-settings"},A=P(()=>m("div",{class:"card-header"},[m("h2",{class:"title"},"账户安全设置"),m("p",{class:"subtitle"},"请谨慎修改您的账户信息")],-1)),M={__name:"index",setup(i){const c=w(),t=w(!1),b=E(),o=k({user:"",old_password:"",new_password:"",confirm_password:""}),x={old_password:[{required:!0,message:"请输入原密码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{validator:(d,s,r)=>{s.length<6?r(new Error("密码至少需要6位")):r()},trigger:"blur"}],confirm_password:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(d,s,r)=>{s!==o.new_password?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]},V=async()=>{try{await c.value.validate(),t.value=!0,(await N(o)).code===200?(t.value=!1,f.success("修改成功"),b.push("/login")):(t.value=!1,f.error("修改失败，请重试"))}catch(d){f.error(d.message||"修改失败"),t.value=!1}},h=()=>{c.value.resetFields()};return(d,s)=>{const r=p("el-input"),n=p("el-form-item"),_=p("el-button"),y=p("el-form"),C=p("el-card");return S(),U("div",F,[e(C,{class:"settings-card"},{default:a(()=>[A,e(y,{ref_key:"formRef",ref:c,model:o,rules:x,"label-position":"top",class:"settings-form"},{default:a(()=>[e(n,{label:"用户名",prop:"user"},{default:a(()=>[e(r,{modelValue:o.user,"onUpdate:modelValue":s[0]||(s[0]=l=>o.user=l),placeholder:"请输入新的用户名(邮箱)",clearable:"","prefix-icon":u(R)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"原密码",prop:"old_password"},{default:a(()=>[e(r,{modelValue:o.old_password,"onUpdate:modelValue":s[1]||(s[1]=l=>o.old_password=l),type:"password","show-password":"",placeholder:"请输入当前密码","prefix-icon":u(B)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"新密码",prop:"new_password"},{default:a(()=>[e(r,{modelValue:o.new_password,"onUpdate:modelValue":s[2]||(s[2]=l=>o.new_password=l),type:"password","show-password":"",placeholder:"6-16位长度","prefix-icon":u(v)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{label:"确认新密码",prop:"confirm_password"},{default:a(()=>[e(r,{modelValue:o.confirm_password,"onUpdate:modelValue":s[3]||(s[3]=l=>o.confirm_password=l),type:"password","show-password":"",placeholder:"请再次输入新密码","prefix-icon":u(v)},null,8,["modelValue","prefix-icon"])]),_:1}),e(n,{class:"form-actions"},{default:a(()=>[e(_,{type:"primary",loading:t.value,onClick:V},{default:a(()=>[g(" 保存修改 ")]),_:1},8,["loading"]),e(_,{onClick:h},{default:a(()=>[g("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},H=D(M,[["__scopeId","data-v-b4e3190c"]]);export{H as default};
