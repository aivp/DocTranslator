import{_ as ve}from"./nodata-CSuNOf8O.js";/* empty css                                                               */import{_ as me,r as g,N as Ve,h as _,i as ye,o as f,c as x,j as t,w as o,a as n,t as U,x as v,F as le,p as se,m as I,k as he,O as $e,n as xe,l as W,M as ee,E as i,q as pe,P as Te,u as Ue,f as Le,Q as qe,R as Ne,S as fe,T as Re,U as Se,V as Ee,W as ze,v as be,X as Fe,Y as Be,Z as Oe,$ as Ye}from"./index-CwiaCLCA.js";const De={class:"flag_tips"},Ie={class:"terms_section"},Pe={class:"terms_header"},je={class:"search_box"},Je={class:"terms_table"},Me={class:"action-buttons"},Ae={key:0,class:"pagination_box"},Xe={class:"btn_box"},He={class:"btn_box"},Ke={__name:"TermEdit",props:{langs:Array,loading:Boolean},emits:["update:modelValue","confirm","refresh"],setup(X,{expose:P,emit:Z}){const w=g(null),E=g([]),R=g(!1),y=g(""),p=g(1),V=g(10),b=g(0),h=g(!1),z=g(!1),L=g(null),u=g({id:"",original:"",comparison_text:""}),$=g(!1),k=g(!1),O={original:[{required:!0,message:"请输入原文",trigger:"blur"}],comparison_text:[{required:!0,message:"请输入对应术语",trigger:"blur"}]};let F=null;const G=()=>{F&&clearTimeout(F),F=setTimeout(()=>{p.value=1,S()},500)},H=s=>{V.value=s,p.value=1,S()},j=s=>{p.value=s,S()},S=async()=>{if(console.log("fetchTermsList 被调用，ID:",d.value.id),!d.value.id){console.log("没有ID，退出获取术语列表");return}R.value=!0;try{const s={page:p.value,limit:V.value};y.value.trim()&&(s.search=y.value.trim());const r=`/api/comparison/${d.value.id}/terms?${new URLSearchParams(s)}`;console.log("请求URL:",r);const q=await ee({url:`/api/comparison/${d.value.id}/terms`,method:"get",params:s});console.log("响应状态:",q.code),q.code===200?(E.value=q.data.data,b.value=q.data.total,console.log("术语列表设置成功，数量:",E.value.length,"总数:",b.value)):i.error(q.message||"获取术语列表失败")}catch(s){console.error("获取术语列表失败:",s),i.error("获取术语列表失败")}finally{R.value=!1}},C=(s,r,q)=>{w.value.clearValidate(["origin_lang","target_lang"]),d.value.origin_lang!=""&&d.value.target_lang!=""&&d.value.origin_lang==d.value.target_lang?q(new Error("源语种与对照语种不能一样")):q()},te={title:[{required:!0,message:"请填写术语标题",trigger:["blur","change"]}],origin_lang:[{required:!0,message:"请选择源语种",trigger:["blur","change"]},{validator:C,trigger:["blur","change"]}],target_lang:[{required:!0,message:"请选择对照语种",trigger:["blur","change"]},{validator:C,trigger:["blur","change"]}]},Y=X,B=g(!1),d=g({id:"",title:"",origin_lang:"",target_lang:"",share_flag:"N"});Ve(B,s=>{console.log("visible 变化:",s,"localForm.id:",d.value.id),s&&d.value.id?(console.log("准备获取术语列表，ID:",d.value.id),Te(()=>{S()})):s&&!d.value.id?console.log("新建术语库模式，不获取术语列表"):console.log("弹窗关闭")});const J=Z,ne=s=>{console.log("TermEdit open 被调用，接收到的数据:",s);const r=s||{};d.value={id:"",title:"",origin_lang:"",target_lang:"",share_flag:"N",...r},console.log("localForm 设置后的值:",d.value),B.value=!0},oe=()=>{B.value=!1,E.value=[],y.value="",p.value=1,b.value=0,J("refresh")},re=async()=>{try{await w.value.validate(),J("confirm",d.value),oe()}catch(s){console.error("表单验证失败:",s)}};P({open:ne});const l=s=>{u.value={id:s.id,original:s.original,comparison_text:s.comparison_text},h.value=!0},e=async()=>{if(!k.value){k.value=!0;try{if(d.value.id)u.value={id:"",original:"",comparison_text:""},h.value=!0;else{if(!d.value.title||!d.value.origin_lang||!d.value.target_lang){i.warning("请先填写术语表标题、源语种和对照语种，然后保存术语库");return}try{$.value=!0,i.info("正在保存术语库，请稍候...");const s=await ee({url:"/api/comparison",method:"post",data:{title:d.value.title,origin_lang:d.value.origin_lang,target_lang:d.value.target_lang,share_flag:d.value.share_flag}});s.code===200?(d.value.id=s.data.id,i.success("术语库保存成功，现在可以新增术语了"),u.value={id:"",original:"",comparison_text:""},h.value=!0):i.error(s.message||"保存术语库失败")}catch(s){console.error("保存术语库失败:",s),i.error("保存术语库失败")}finally{$.value=!1}}}finally{k.value=!1}}},a=async()=>{try{if(await L.value.validate(),z.value=!0,u.value.id){const s=await ee({url:`/api/comparison/term/${u.value.id}`,method:"put",data:{original:u.value.original,comparison_text:u.value.comparison_text}});s.code===200?(i.success("编辑成功"),h.value=!1,S(),J("refresh")):i.error(s.message||"编辑失败")}else{if(!d.value.id){i.error("术语库未保存，无法新增术语");return}const s=await ee({url:`/api/comparison/${d.value.id}/terms`,method:"post",data:{original:u.value.original,comparison_text:u.value.comparison_text}});s.code===200?(i.success("新增成功"),h.value=!1,S(),J("refresh")):i.error(s.message||"新增失败")}}catch(s){console.error("操作术语失败:",s),i.error("操作术语失败")}finally{z.value=!1}},N=s=>{pe.confirm(`确定要删除这条术语记录吗？
原文：${s.original}
对应术语：${s.comparison_text}`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!1}).then(async()=>{try{const r=await ee({url:`/api/comparison/term/${s.id}`,method:"delete"});r.code===200?(i.success("删除成功"),S(),J("refresh")):i.error(r.message||"删除失败")}catch(r){console.error("删除术语失败:",r),i.error("删除术语失败")}}).catch(()=>{})};return(s,r)=>{const q=_("el-switch"),K=_("el-input"),D=_("el-form-item"),Q=_("el-col"),ae=_("el-option"),c=_("el-select"),M=_("el-row"),T=_("el-icon"),A=_("el-button"),ie=_("el-table-column"),we=_("el-table"),ke=_("el-pagination"),_e=_("el-form"),ge=_("el-dialog"),Ce=ye("loading");return f(),x(le,null,[t(ge,{modelValue:B.value,"onUpdate:modelValue":r[7]||(r[7]=m=>B.value=m),title:"术语编辑器",width:"75%",fullscreen:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":"",class:"term_dialog"},{header:o(({close:m,titleId:ue,titleClass:de})=>[r[12]||(r[12]=n("span",{class:"title"},"术语编辑器",-1)),t(q,{modelValue:d.value.share_flag,"onUpdate:modelValue":r[0]||(r[0]=ce=>d.value.share_flag=ce),"active-value":"Y","inactive-value":"N"},null,8,["modelValue"]),n("div",De,"共享"+U(d.value.share_flag=="Y"?"开启":"关闭"),1)]),footer:o(()=>[n("div",Xe,[t(A,{type:"primary",color:"#055CF9",disabled:Y.loading||$.value,loading:Y.loading||$.value,onClick:re},{default:o(()=>[v(U(Y.loading||$.value?"保存术语库中...":"保存"),1)]),_:1},8,["disabled","loading"]),t(A,{onClick:oe},{default:o(()=>r[16]||(r[16]=[v("关闭",-1)])),_:1,__:[16]})])]),default:o(()=>[t(_e,{ref_key:"termformRef",ref:w,model:d.value,rules:te,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[t(M,{gutter:20},{default:o(()=>[t(Q,{span:24},{default:o(()=>[t(D,{label:"术语表标题",required:"",prop:"title",width:"100%"},{default:o(()=>[t(K,{modelValue:d.value.title,"onUpdate:modelValue":r[1]||(r[1]=m=>d.value.title=m),type:"text",placeholder:"请输入术语表标题",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,{xs:24,sm:12},{default:o(()=>[t(D,{label:"源语种",required:"",prop:"origin_lang",width:"100%"},{default:o(()=>[t(c,{modelValue:d.value.origin_lang,"onUpdate:modelValue":r[2]||(r[2]=m=>d.value.origin_lang=m),placeholder:"请选择",filterable:"","allow-create":"",clearable:""},{default:o(()=>[(f(!0),x(le,null,se(Y.langs,m=>(f(),I(ae,{key:m,name:m,value:m},null,8,["name","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(Q,{xs:24,sm:12},{default:o(()=>[t(D,{label:"对照语种",required:"",prop:"target_lang",width:"100%"},{default:o(()=>[t(c,{modelValue:d.value.target_lang,"onUpdate:modelValue":r[3]||(r[3]=m=>d.value.target_lang=m),placeholder:"请选择",filterable:"","allow-create":"",clearable:""},{default:o(()=>[(f(!0),x(le,null,se(Y.langs,m=>(f(),I(ae,{key:m,name:m,value:m},null,8,["name","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n("div",Ie,[n("div",Pe,[r[13]||(r[13]=n("h3",null,"术语列表",-1)),n("div",je,[t(K,{modelValue:y.value,"onUpdate:modelValue":r[4]||(r[4]=m=>y.value=m),placeholder:"搜索术语...",clearable:"",onInput:G,style:{width:"300px"}},{prefix:o(()=>[t(T,null,{default:o(()=>[t(he($e))]),_:1})]),_:1},8,["modelValue"]),t(A,{type:"primary",loading:k.value,disabled:k.value,onClick:e,style:{"margin-left":"12px"}},{default:o(()=>[v(U(k.value?"处理中...":"新增术语"),1)]),_:1},8,["loading","disabled"])])]),n("div",Je,[xe((f(),I(we,{data:E.value,style:{width:"100%"},border:"",stripe:""},{default:o(()=>{var m,ue;return[t(ie,{prop:"original",label:((m=d.value.value)==null?void 0:m.origin_lang)||"源语种","min-width":"200","show-overflow-tooltip":""},null,8,["label"]),t(ie,{prop:"comparison_text",label:((ue=d.value.value)==null?void 0:ue.target_lang)||"对照语种","min-width":"200","show-overflow-tooltip":""},null,8,["label"]),t(ie,{label:"操作",width:"120",fixed:"right",align:"center"},{default:o(({row:de})=>[n("div",Me,[t(A,{type:"primary",size:"small",onClick:ce=>l(de),text:""},{default:o(()=>r[14]||(r[14]=[v(" 编辑 ",-1)])),_:2,__:[14]},1032,["onClick"]),t(A,{type:"danger",size:"small",onClick:ce=>N(de),text:""},{default:o(()=>r[15]||(r[15]=[v(" 删除 ",-1)])),_:2,__:[15]},1032,["onClick"])])]),_:1})]}),_:1},8,["data"])),[[Ce,R.value]]),b.value>0?(f(),x("div",Ae,[t(ke,{"current-page":p.value,"onUpdate:currentPage":r[5]||(r[5]=m=>p.value=m),"page-size":V.value,"onUpdate:pageSize":r[6]||(r[6]=m=>V.value=m),"page-sizes":[10,20,50],total:b.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:j},null,8,["current-page","page-size","total"])])):W("",!0)])])]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(ge,{modelValue:h.value,"onUpdate:modelValue":r[11]||(r[11]=m=>h.value=m),title:u.value.id?"编辑术语":"新增术语",width:"600px","destroy-on-close":""},{footer:o(()=>[n("div",He,[t(A,{onClick:r[10]||(r[10]=m=>h.value=!1)},{default:o(()=>r[17]||(r[17]=[v("取消",-1)])),_:1,__:[17]}),t(A,{type:"primary",color:"#055CF9",loading:z.value,onClick:a},{default:o(()=>[v(U(u.value.id?"确认":"保存"),1)]),_:1},8,["loading"])])]),default:o(()=>[t(_e,{ref_key:"editTermFormRef",ref:L,model:u.value,rules:O,"label-width":"80px"},{default:o(()=>[t(D,{label:"原文",prop:"original"},{default:o(()=>[t(K,{modelValue:u.value.original,"onUpdate:modelValue":r[8]||(r[8]=m=>u.value.original=m),type:"textarea",rows:3,placeholder:"请输入原文"},null,8,["modelValue"])]),_:1}),t(D,{label:"对应术语",prop:"comparison_text"},{default:o(()=>[t(K,{modelValue:u.value.comparison_text,"onUpdate:modelValue":r[9]||(r[9]=m=>u.value.comparison_text=m),type:"textarea",rows:3,placeholder:"请输入对应术语"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}},Qe=me(Ke,[["__scopeId","data-v-937f8fd6"]]),We={class:"flag_tips"},Ze={class:"prompt-section"},Ge={class:"prompt-section"},el={class:"prompt-section"},ll={class:"btn_box"},tl={__name:"PromptEdit",props:{loading:Boolean},emits:["confirm","close"],setup(X,{expose:P,emit:Z}){const w={title:[{required:!0,message:"请填写提示语标题",trigger:["blur","change"]}],role_content:[{required:!0,message:"请填写角色内容",trigger:["blur","change"]}],task_content:[{required:!0,message:"请填写任务内容",trigger:["blur","change"]}],requirements_content:[{required:!0,message:"请填写翻译要求",trigger:["blur","change"]}]},E=Z,R=g(null),y=g(!1),p=g({title:"",share_flag:"N",role_content:"",task_content:"",requirements_content:"",content:""}),V=()=>{y.value=!0},b=()=>{y.value=!1},h=()=>{R.value.validate(L=>{L&&(E("confirm",p.value),b())})};return P({open:V,close:b,updateForm:L=>{p.value=L},localForm:p}),(L,u)=>{const $=_("el-switch"),k=_("el-input"),O=_("el-form-item"),F=_("el-col"),G=_("el-row"),H=_("el-form"),j=_("el-button"),S=_("el-dialog");return f(),I(S,{modelValue:y.value,"onUpdate:modelValue":u[5]||(u[5]=C=>y.value=C),"destroy-on-close":"",title:"提示语编辑器",width:"90%","modal-class":"term_dialog"},{header:o(({close:C,titleId:te,titleClass:Y})=>[u[6]||(u[6]=n("span",{class:"title"},"提示语编辑器",-1)),t($,{modelValue:p.value.share_flag,"onUpdate:modelValue":u[0]||(u[0]=B=>p.value.share_flag=B),"active-value":"Y","inactive-value":"N"},null,8,["modelValue"]),n("div",We,"共享"+U(p.value.share_flag=="Y"?"开启":"关闭"),1)]),default:o(()=>[t(H,{ref_key:"promptformRef",ref:R,model:p.value,rules:w,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[t(G,{gutter:20},{default:o(()=>[t(F,{span:24},{default:o(()=>[t(O,{label:"提示语标题",required:"",prop:"title",width:"100%"},{default:o(()=>[t(k,{modelValue:p.value.title,"onUpdate:modelValue":u[1]||(u[1]=C=>p.value.title=C),type:"text",placeholder:"请输入提示语标题",maxlength:"150","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),t(F,{span:24},{default:o(()=>[t(O,{label:"# 角色",required:"",prop:"role_content",width:"100%"},{default:o(()=>[n("div",Ze,[t(k,{modelValue:p.value.role_content,"onUpdate:modelValue":u[2]||(u[2]=C=>p.value.role_content=C),type:"textarea",rows:4,resize:"none",placeholder:"请输入翻译专家的角色描述",maxlength:"150","show-word-limit":""},null,8,["modelValue"]),u[7]||(u[7]=n("div",{class:"example-text"}," 示例：你是一名专业的法律翻译专家,精通中文和英文,尤其擅长处理商业合同和法律文件。 ",-1))])]),_:1})]),_:1}),t(F,{span:24},{default:o(()=>[t(O,{label:"# 任务",required:"",prop:"task_content",width:"100%"},{default:o(()=>[n("div",Ge,[t(k,{modelValue:p.value.task_content,"onUpdate:modelValue":u[3]||(u[3]=C=>p.value.task_content=C),type:"textarea",rows:4,resize:"none",placeholder:"请输入具体的翻译任务",maxlength:"150","show-word-limit":""},null,8,["modelValue"]),u[8]||(u[8]=n("div",{class:"example-text"}," 示例：我需要你将以下中文法律文本翻译成专业、精准、正式的英文。 ",-1))])]),_:1})]),_:1}),t(F,{span:24},{default:o(()=>[t(O,{label:"# 翻译要求",required:"",prop:"requirements_content",width:"100%"},{default:o(()=>[n("div",el,[t(k,{modelValue:p.value.requirements_content,"onUpdate:modelValue":u[4]||(u[4]=C=>p.value.requirements_content=C),type:"textarea",rows:4,resize:"none",placeholder:"请输入翻译的具体要求",maxlength:"500","show-word-limit":""},null,8,["modelValue"]),u[9]||(u[9]=n("div",{class:"example-text"},[v(" 示例："),n("br"),v(" 1. **忠实原文**：严格按照原文的含义和法律意图进行翻译,不得添加或删减信息。"),n("br"),v(" 2. **术语精准**：使用英美法系(Common law) 通用的标准法律术语。"),n("br"),v(" 3. **语气正式**：保持法律文件固有的严谨、客观和正式的语体。"),n("br"),v(" 4. **语句清晰**：译文必须清晰、无歧义,符合英文法律文书的表达习惯。"),n("br"),v(" 5. **格式保留**：保持原文的段落、编号和基本格式。 ")],-1))])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),n("div",ll,[t(j,{disabled:X.loading,onClick:b},{default:o(()=>u[10]||(u[10]=[v("取消",-1)])),_:1,__:[10]},8,["disabled"]),t(j,{type:"primary",color:"#055CF9",disabled:X.loading,loading:X.loading,onClick:h},{default:o(()=>u[11]||(u[11]=[v(" 保存 ",-1)])),_:1,__:[11]},8,["disabled","loading"])])]),_:1},8,["modelValue"])}}},ol=me(tl,[["__scopeId","data-v-d525278e"]]),al={class:"page-center","element-loading-text":"loading...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.7)"},sl={class:"container"},nl={class:"tab_box"},rl={key:0,class:"content_box"},il={class:"flex_box flex-between phone_box"},ul={key:0,class:"btn_box"},dl={key:1,class:"btn_box"},cl={key:0,class:"term_box"},pl={class:"term_li"},ml={class:"flex_box title_box flex-between"},_l=["title"],gl={class:"des"},vl={class:"term_count"},fl={class:"count_text"},bl={class:"btn_box flex_box flex-between"},yl={class:"left"},hl={class:"right"},xl={key:0,class:"table_box"},wl={key:1,class:"no_terms"},kl={key:1,class:"no_data"},Cl={key:1,class:"prompt_box"},Vl={class:"term_li"},$l={class:"flex_box title_box flex-between"},Tl=["title"],Ul={key:0,class:"btn_box flex_box flex-between"},Ll={class:"left"},ql={class:"right"},Nl={key:1,class:"btn_box"},Rl={class:"text_box"},Sl={class:"text"},El={key:1,class:"no_data"},zl={__name:"index",setup(X){const P=Ue(),Z=g("/api/api/comparison/import"),w=g(!1),E=g([]),R=g([]),y=g(null),p=g(!1),V=g(null),b=g("terms"),h=g(!1),z=g(!1),L=g(!1);function u(l){b.value=l}const $=async()=>{w.value=!1;try{const l=await qe();l.code===200&&(E.value=l.data.data)}catch(l){console.error("获取术语表数据失败:",l)}w.value=!1},k=async()=>{w.value=!1;try{const l=await Ne();l.code===200&&(R.value=JSON.parse(JSON.stringify(l.data.data)),fe.prompt&&R.value.unshift({title:"默认提示语(无法删除)",content:fe.prompt,undelete:!0}))}catch(l){console.error("获取提示语数据失败:",l)}w.value=!1},O=["中文","英语","日语","俄语","阿拉伯语","西班牙语","韩语","德语"],F=l=>{const e=l;p.value=!0,e.id?Re(e.id,e).then(a=>{p.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),V.value.close(),k()):i({message:a.message,type:"error"})}).catch(a=>{i({message:"接口异常",type:"error"})}):Se(e).then(a=>{p.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),V.value.close(),k()):i({message:a.message,type:"error"})}).catch(a=>{i({message:"接口异常",type:"error"})}),V.value.close(),p.value=!1},G=l=>{const e=l;console.log("保存术语表数据:",e),p.value=!0,e.id?(console.log("执行编辑操作，ID:",e.id),Ee(e.id,e).then(a=>{console.log("编辑成功响应:",a),console.log("响应数据类型:",typeof a),console.log("响应数据键:",Object.keys(a||{})),p.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),$(),setTimeout(()=>{y.value&&y.value.close()},100)):i({message:a.message||"保存失败",type:"error"})}).catch(a=>{p.value=!1,console.error("编辑术语表失败:",a),i({message:"接口异常",type:"error"})})):(console.log("执行新建操作"),ze(e).then(a=>{console.log("新建成功响应:",a),console.log("响应数据类型:",typeof a),console.log("响应数据键:",Object.keys(a||{})),p.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),$(),setTimeout(()=>{y.value&&y.value.close()},100)):i({message:a.message||"保存失败",type:"error"})}).catch(a=>{p.value=!1,console.error("新建术语表失败:",a),i({message:"接口异常",type:"error"})}))};function H(l){l?y.value.open(l):y.value.open({title:"",share_flag:"N",origin_lang:"",target_lang:""})}function j(l){V.value.open(),l?V.value.updateForm(JSON.parse(JSON.stringify(l))):V.value.updateForm({title:"",share_flag:"N",content:""})}function S(l){pe.confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=!0,Fe(l.id).then(e=>{e.code==200?(i({message:"删除成功",type:"success"}),$()):i({message:e.message,type:"error"})})})}function C(l){w.value=!0,Be(l.id,{share_flag:l.share_flag}).then(e=>{w.value=!1,e.code==200?i({message:"操作成功",type:"success"}):(i({message:e.message,type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y")}).catch(e=>{i({message:"接口异常",type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y"})}async function te(l){try{z.value=!0;const e=await fetch(`/api/api/comparison/export/${l.id}`,{headers:{Authorization:`Bearer ${P.token}`}});if(!e.ok)throw new Error("文件下载失败");const a=await e.blob(),N=window.URL.createObjectURL(a),s=document.createElement("a");s.href=N,s.download=`${l.title}.xlsx`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(N),i({message:"导出成功",type:"success"})}catch(e){console.error("下载失败:",e),i.error("文件下载失败，请稍后重试")}finally{z.value=!1}}async function Y(){try{L.value=!0;const l=await fetch("/api/api/comparison/export/all",{headers:{Authorization:`Bearer ${P.token}`}});if(!l.ok)throw new Error("术语表导出失败");const e=await l.blob(),a=window.URL.createObjectURL(e),N=document.createElement("a");N.href=a,N.download=`all_terms_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(a),i({message:"批量导出成功",type:"success"})}catch(l){console.error("导出失败:",l),i.error("术语表导出失败，请稍后重试")}finally{L.value=!1}}function B(l){window.open("/api/api/comparison/template")}function d(l){console.log("上传成功"),console.log(l),h.value=!1,l.code==200?(i({message:"导入成功",type:"success"}),$()):i({message:l.message,type:"error"})}function J(l){console.log("上传失败"),console.log(l),h.value=!1;let e="导入失败";try{if(l.message){const a=JSON.parse(l.message);a.message&&(e=decodeURIComponent(JSON.stringify(a.message).replace(/\\u/g,"%u")))}}catch(a){console.error("解析错误响应失败:",a),l.message&&typeof l.message=="string"&&(e=l.message)}i({message:e,type:"error"})}function ne(l){const a=l.name.substring(l.name.lastIndexOf(".")+1)==="xlsx";return a?(h.value=!0,console.log("isXlsx",a),a):(i({message:"请上传模板格式的文件",type:"error"}),!1)}function oe(l){w.value=!0,l.id&&Oe(l.id,{share_flag:l.share_flag}).then(e=>{w.value=!1,e.code==200?i({message:"操作成功",type:"success"}):(i({message:e.message,type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y")}).catch(e=>{i({message:"接口异常",type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y"})}function re(l){pe.confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=!0,Ye(l.id).then(e=>{e.code==200?(i({message:"删除成功",type:"success"}),k()):i({message:e.message,type:"error"})})})}return Le(()=>{$(),k()}),(l,e)=>{const a=_("el-button"),N=_("el-button-group"),s=_("el-upload"),r=_("el-switch"),q=_("el-table-column"),K=_("el-table"),D=_("el-col"),Q=_("el-row"),ae=ye("loading");return xe((f(),x("div",al,[n("div",sl,[n("div",nl,[e[4]||(e[4]=n("div",{class:"tab_li actived"},"我的",-1)),n("div",{class:"tab_li",onClick:e[0]||(e[0]=c=>l.$router.push("/corpus/square"))},"广场")]),(f(),x("div",rl,[n("div",il,[t(N,null,{default:o(()=>[t(a,{class:be(b.value=="terms"?"btn_active":"my_button"),plain:b.value!="terms",type:b.value=="terms"?"primary":"",onClick:e[1]||(e[1]=c=>u("terms"))},{default:o(()=>e[5]||(e[5]=[v(" 我的术语表 ",-1)])),_:1,__:[5]},8,["class","plain","type"]),t(a,{class:be(b.value=="prompt"?"btn_active":"my_button"),plain:b.value!="prompt",type:b.value=="prompt"?"primary":"",onClick:e[2]||(e[2]=c=>u("prompt"))},{default:o(()=>e[6]||(e[6]=[v(" 我的提示语 ",-1)])),_:1,__:[6]},8,["class","plain","type"])]),_:1}),b.value=="terms"?(f(),x("div",ul,[t(a,{type:"primary",color:"#055CF9",onClick:H},{default:o(()=>e[7]||(e[7]=[v("新建",-1)])),_:1,__:[7]}),t(a,{type:"primary",style:{margin:"0 8px"},onClick:e[3]||(e[3]=c=>B())},{default:o(()=>e[8]||(e[8]=[v(" 模板下载 ",-1)])),_:1,__:[8]}),t(s,{name:"file","before-upload":ne,action:Z.value,headers:{Authorization:"Bearer "+he(P).token},"show-file-list":!1,"on-success":(c,M,T)=>d(c),"on-error":(c,M,T)=>J(c),disabled:h.value,style:{display:"inline-block"}},{default:o(()=>[t(a,{type:"primary",loading:h.value,disabled:h.value},{default:o(()=>[v(U(h.value?"导入中...":"导入文件"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["action","headers","on-success","on-error","disabled"]),t(a,{type:"",onClick:Y,loading:L.value,disabled:L.value},{default:o(()=>[v(U(L.value?"导出中...":"全部导出"),1)]),_:1},8,["loading","disabled"])])):W("",!0),b.value=="prompt"?(f(),x("div",dl,[t(a,{type:"primary",color:"#055CF9",onClick:j},{default:o(()=>e[9]||(e[9]=[v("新建",-1)])),_:1,__:[9]})])):W("",!0)]),b.value=="terms"?(f(),x("div",cl,[E.value.length>0?(f(),I(Q,{key:0,gutter:24},{default:o(()=>[(f(!0),x(le,null,se(E.value,(c,M)=>(f(),I(D,{xs:24,sm:8,key:M},{default:o(()=>[n("div",pl,[n("div",ml,[n("div",{class:"t",title:c.title},U(c.title),9,_l),n("div",gl,U(c.origin_lang)+"-"+U(c.target_lang),1)]),n("div",vl,[n("span",fl,"共 "+U(c.term_count||0)+" 条术语",1)]),n("div",bl,[n("div",yl,[t(a,{type:"text",onClick:T=>H(c)},{default:o(()=>e[10]||(e[10]=[v("编辑",-1)])),_:2,__:[10]},1032,["onClick"]),t(a,{type:"text",style:{color:"red"},onClick:T=>S(c)},{default:o(()=>e[11]||(e[11]=[v("删除",-1)])),_:2,__:[11]},1032,["onClick"]),t(a,{type:"text",onClick:T=>te(c),loading:z.value,disabled:z.value},{default:o(()=>[v(U(z.value?"导出中...":"导出"),1)]),_:2},1032,["onClick","loading","disabled"])]),n("div",hl,[t(r,{modelValue:c.share_flag,"onUpdate:modelValue":T=>c.share_flag=T,"active-value":"Y","inactive-value":"N",onChange:T=>C(c)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),c.sample_terms&&c.sample_terms.length>0?(f(),x("div",xl,[t(K,{data:c.sample_terms,style:{width:"100%"},"max-height":"340",border:"","header-cell-class-name":"table_title","tooltip-effect":"light"},{default:o(()=>[t(q,{prop:"original",label:c.origin_lang,"show-overflow-tooltip":""},null,8,["label"]),t(q,{prop:"comparison_text",label:c.target_lang,"show-overflow-tooltip":""},null,8,["label"])]),_:2},1032,["data"])])):(f(),x("div",wl,e[12]||(e[12]=[n("div",{class:"text"},"暂无术语数据",-1)])))])]),_:2},1024))),128))]),_:1})):(f(),x("div",kl,e[13]||(e[13]=[n("img",{src:ve,alt:""},null,-1),n("div",{class:"text"},"暂无数据",-1)])))])):W("",!0),b.value=="prompt"?(f(),x("div",Cl,[R.value.length>0?(f(),I(Q,{key:0,gutter:24},{default:o(()=>[(f(!0),x(le,null,se(R.value,(c,M)=>(f(),I(D,{xs:24,sm:8,key:M},{default:o(()=>[n("div",Vl,[n("div",$l,[n("div",{class:"t",title:c.title},U(c.title),9,Tl)]),c.undelete?(f(),x("div",Nl)):(f(),x("div",Ul,[n("div",Ll,[t(a,{type:"text",onClick:T=>j(c)},{default:o(()=>e[14]||(e[14]=[v("编辑",-1)])),_:2,__:[14]},1032,["onClick"]),t(a,{type:"text",style:{color:"red"},onClick:T=>re(c)},{default:o(()=>e[15]||(e[15]=[v("删除",-1)])),_:2,__:[15]},1032,["onClick"])]),n("div",ql,[t(r,{modelValue:c.share_flag,"onUpdate:modelValue":T=>c.share_flag=T,"active-value":"Y","inactive-value":"N",onChange:T=>oe(c)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),n("div",Rl,[n("div",Sl,U(c.content),1)])])]),_:2},1024))),128))]),_:1})):(f(),x("div",El,e[16]||(e[16]=[n("img",{src:ve,alt:""},null,-1),n("div",{class:"text"},"暂无数据",-1)])))])):W("",!0)])),W("",!0)]),t(Qe,{ref_key:"termEditRef",ref:y,langs:O,loading:p.value,onConfirm:G,onRefresh:$},null,8,["loading"]),t(ol,{ref_key:"promptEditRef",ref:V,loading:p.value,onConfirm:F},null,8,["loading"])])),[[ae,w.value]])}}},Yl=me(zl,[["__scopeId","data-v-61a47da0"]]);export{Yl as default};
