import{_ as b,y as C,r as v,a1 as y,h as c,o as r,c as d,a as l,j as a,w as i,a3 as E,v as f,x as u,t as z,E as p,a5 as P}from"./index-CwiaCLCA.js";const A={class:"change-password-page"},B={class:"change-password-container"},N={class:"password-tips"},U={key:0,class:"el-icon-check"},Z={key:1,class:"el-icon-close"},j={key:0,class:"el-icon-check"},q={key:1,class:"el-icon-close"},K={key:0,class:"el-icon-check"},T={key:1,class:"el-icon-close"},$={__name:"reset",setup(D){const h=C(),m=v(),w=v(!1),s=y({oldpwd:"",newpwd:"",newpwd_confirmation:""}),k=y({oldpwd:[{required:!0,message:"请填写原密码",trigger:"blur"}],newpwd:[{validator:(_,e,o)=>{e?e.length<6?o(new Error("密码至少需要6位")):!/[a-zA-Z]/.test(e)||!/[0-9]/.test(e)?o(new Error("密码需包含字母和数字")):o():o(new Error("请填写新密码"))},trigger:"blur"}],newpwd_confirmation:[{required:!0,message:"请填写确认密码",trigger:"blur"}]}),g=async _=>{_.validate(async(e,o)=>{if(e){if(s.newpwd!==s.newpwd_confirmation){p.error("两次密码输入不一致");return}w.value=!0;try{const t=await P(s);t.code===200?(p.success("密码修改成功"),setTimeout(()=>{h.push({name:"login"})},1500)):p.error(t.message)}catch(t){p.error(t.message||"密码修改失败")}finally{w.value=!1}}else p.error(o[Object.keys(o)[0]][0].message)})};return(_,e)=>{const o=c("el-input"),t=c("el-form-item"),V=c("el-button"),x=c("el-form");return r(),d("div",A,[l("div",B,[e[8]||(e[8]=l("div",{class:"change-password-header"},[l("h1",{class:"change-password-title"},"修改密码"),l("p",{class:"change-password-subtitle"},"请填写以下信息以修改您的密码")],-1)),a(x,{ref_key:"form",ref:m,model:s,"show-message":!1,rules:k,onKeyup:e[4]||(e[4]=E(n=>g(m.value),["enter"]))},{default:i(()=>[a(t,{label:"",prop:"oldpwd"},{default:i(()=>[a(o,{modelValue:s.oldpwd,"onUpdate:modelValue":e[0]||(e[0]=n=>s.oldpwd=n),type:"password","show-password":"",placeholder:"原密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),a(t,{label:"",prop:"newpwd"},{default:i(()=>[a(o,{modelValue:s.newpwd,"onUpdate:modelValue":e[1]||(e[1]=n=>s.newpwd=n),type:"password","show-password":"",placeholder:"设置新密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"]),l("div",N,[l("div",{class:f(["tip-item",{valid:s.newpwd.length>=6}])},[s.newpwd.length>=6?(r(),d("i",U)):(r(),d("i",Z)),e[5]||(e[5]=u(" 至少6位字符 ",-1))],2),l("div",{class:f(["tip-item",{valid:/[a-zA-Z]/.test(s.newpwd)}])},[/[a-zA-Z]/.test(s.newpwd)?(r(),d("i",j)):(r(),d("i",q)),e[6]||(e[6]=u(" 包含字母 ",-1))],2),l("div",{class:f(["tip-item",{valid:/[0-9]/.test(s.newpwd)}])},[/[0-9]/.test(s.newpwd)?(r(),d("i",K)):(r(),d("i",T)),e[7]||(e[7]=u(" 包含数字 ",-1))],2)])]),_:1}),a(t,{label:"",prop:"newpwd_confirmation"},{default:i(()=>[a(o,{modelValue:s.newpwd_confirmation,"onUpdate:modelValue":e[2]||(e[2]=n=>s.newpwd_confirmation=n),type:"password","show-password":"",placeholder:"确认新密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),a(t,{label:"",class:"center"},{default:i(()=>[a(V,{type:"primary",size:"large",class:"change-password-btn",onClick:e[3]||(e[3]=n=>g(m.value)),loading:w.value},{default:i(()=>[u(z(w.value?"提交中...":"提交"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])])}}},M=b($,[["__scopeId","data-v-faacad55"]]);export{M as default};
