import{N as D,_ as Te,u as Me,r as f,O as Ue,e as Ee,f as Be,h as Ce,i as V,j as De,o as d,c as m,a as n,k as r,w as s,t as g,m as b,p as Re,n as k,E as c,v as ie,y as v,x as Ae,F as R,q as A}from"./index-CnQxGHSk.js";const j={uploadVideo:y=>D({url:"/video/upload",method:"post",data:y,headers:{"Content-Type":"multipart/form-data"}}),startTranslate:y=>D({url:"/video/translate",method:"post",data:y,headers:{"Content-Type":"application/json"}}),getVideoStatus:y=>D({url:`/video/status/${y}`,method:"get"}),getVideoList:y=>D({url:"/video/list",method:"get",params:y}),deleteVideo:y=>D({url:`/video/${y}`,method:"delete"}),downloadVideo:y=>D({url:`/video/${y}/download`,method:"get",responseType:"blob"}),getLanguages:()=>D({url:"/video/languages",method:"get"}),getVoices:y=>D({url:"/video/voices",method:"get",params:y})},je={name:"VideoTranslate",setup(){const y=Me(),o=f(),T=f(null),a=f(!1),H=f(!1),I=f(!1),N=f([]),h=f([]),p=f(""),x=f(1),L=f(10),K=f(0),W=f(!1),G=f(),z=f([]),Q=f(null),O=f(!1),M=f({}),U=f({}),P=f({}),B=f([]),l="/api/video/upload",E=".mp4,.avi,.mov,.wmv,.flv,.mkv,.webm",_=Ue({video_id:null,source_language:"auto",target_languages:[],speaker_num:0,lipsync_enabled:!1,lip_sync_type:0,voices_map:{},terminology_ids:[],style:"professional"}),F=[{value:"affectionate",label:"深情 (Affectionate)"},{value:"angry",label:"愤怒 (Angry)"},{value:"calm",label:"平静 (Calm)"},{value:"cheerful",label:"愉快 (Cheerful)"},{value:"depressed",label:"沮丧 (Depressed)"},{value:"disgruntled",label:"不满 (Disgruntled)"},{value:"embarrassed",label:"尴尬 (Embarrassed)"},{value:"empathetic",label:"共情 (Empathetic)"},{value:"excited",label:"兴奋 (Excited)"},{value:"fearful",label:"恐惧 (Fearful)"},{value:"friendly",label:"友好 (Friendly)"},{value:"unfriendly",label:"不友好 (Unfriendly)"},{value:"sad",label:"悲伤 (Sad)"},{value:"serious",label:"严肃 (Serious)"},{value:"relaxed",label:"放松 (Relaxed)"},{value:"professional",label:"专业 (Professional)"}],X={source_language:[{required:!0,message:"请选择源语言",trigger:"change"}],target_languages:[{required:!0,message:"请选择目标语言",trigger:"change"},{type:"array",min:1,message:"至少选择一个目标语言",trigger:"change"}]},J=Ee(()=>T.value&&_.source_language&&_.target_languages.length>0&&!I.value),Y=e=>{const t=e.type.startsWith("video/"),u=e.size/1024/1024<300;return t?u?!0:(c.error("视频文件大小不能超过 300MB!"),!1):(c.error("只能上传视频文件!"),!1)},Z=(e,t)=>{e.code===200?(T.value={id:e.data.id,name:e.data.filename,url:e.data.video_url,size:e.data.file_size},_.video_id=e.data.id,c.success("视频上传成功!"),C()):c.error(e.message||"上传失败")},$=e=>{console.error("Upload error:",e),c.error("上传失败，请重试")},i=()=>{c.warning("最多只能上传一个视频文件")},de=(e,t)=>{a.value=t.length>0},ce=()=>(T.value=null,_.video_id=null,ee(),!0),ee=()=>{Object.assign(_,{video_id:null,source_language:"auto",target_languages:[],speaker_num:0,lipsync_enabled:!1,lip_sync_type:0,voices_map:{},terminology_ids:[],style:"professional"}),Q.value=null,z.value=[],O.value=!1,M.value={},U.value={},P.value={}},te=()=>{if(!T.value){c.warning("请先上传视频");return}ee(),_.video_id=T.value.id,oe(),W.value=!0},ue=e=>{if(!e)return"0 B";const t=1024,u=["B","KB","MB","GB"],w=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,w)).toFixed(2))+" "+u[w]},ge=async()=>{if(G.value){try{await G.value.validate()}catch{return}if(J.value){I.value=!0;try{const e={..._,voices_map:M.value};if(console.log("发送翻译请求数据:",e),console.log("当前视频:",T.value),console.log("语音映射:",M.value),!e.video_id){c.error("视频ID不能为空"),I.value=!1;return}if(!e.target_languages||e.target_languages.length===0){c.error("请选择目标语言"),I.value=!1;return}const t=await j.startTranslate(e);t.code===200?(c.success("翻译任务已启动!"),W.value=!1,C(),ee(),T.value=null,o.value.clearFiles(),setTimeout(()=>{ae()},1e3)):t.message&&t.message.includes("必须选择AI语音")?c.error(t.message):c.error(t.message||"启动翻译失败")}catch(e){console.error("Start translate error:",e),c.error("启动翻译失败，请重试")}finally{I.value=!1}}}},C=async()=>{H.value=!0;try{const e={page:x.value,per_page:L.value};p.value&&(e.status=p.value);const t=await j.getVideoList(e);t.code===200?(N.value=t.data.videos,K.value=t.data.total,N.value.filter(w=>w.status==="processing").length>0?ae():le()):c.error(t.message||"获取视频列表失败")}catch(e){console.error("Load video list error:",e),c.error("获取视频列表失败")}finally{H.value=!1}},ne=async()=>{try{const e=await j.getLanguages();e.code===200?h.value=e.data.languages:h.value=[{lang_code:"en",lang_name:"English"},{lang_code:"zh",lang_name:"Chinese (Simplified)"},{lang_code:"fr",lang_name:"French"},{lang_code:"de",lang_name:"German"},{lang_code:"ja",lang_name:"Japanese"},{lang_code:"ko",lang_name:"Korean"},{lang_code:"es",lang_name:"Spanish"},{lang_code:"ru",lang_name:"Russian"}]}catch(e){console.error("Load languages error:",e),h.value=[{lang_code:"en",lang_name:"English"},{lang_code:"zh",lang_name:"Chinese (Simplified)"},{lang_code:"fr",lang_name:"French"},{lang_code:"de",lang_name:"German"},{lang_code:"ja",lang_name:"Japanese"},{lang_code:"ko",lang_name:"Korean"},{lang_code:"es",lang_name:"Spanish"},{lang_code:"ru",lang_name:"Russian"}]}},se=async e=>{try{if(U.value[e])return U.value[e];P.value[e]=!0;const t={page:1,size:100};e&&(t.language_code=e);const u=await j.getVoices(t);if(u.code===200){const w=u.data.result||[];return U.value[e]=w,w}else return U.value[e]=[],[]}catch(t){return console.error("Load voices error:",t),U.value[e]=[],[]}finally{P.value[e]=!1}},_e=async e=>{const t=Object.keys(M.value);t.filter(S=>!e.includes(S)).forEach(S=>{delete M.value[S]});const w=e.filter(S=>!t.includes(S));for(const S of w)await se(S)},me=(e,t)=>{t?M.value[e]=t:delete M.value[e]},fe=e=>U.value[e]||[],oe=async()=>{try{console.log("开始加载术语库...");const e=await D({url:"/comparison/my",method:"get"});console.log("术语库API响应:",e),e.code===200?(B.value=e.data.data||e.data.comparisons||[],console.log("加载术语库成功:",B.value.length,"个术语库"),console.log("术语库详情:",B.value)):(console.error("加载术语库失败:",e.message),B.value=[])}catch(e){console.error("加载术语库异常:",e),B.value=[]}},ve=e=>{e&&B.value.length===0&&oe()},pe=e=>{e.translated_video_url?window.open(e.translated_video_url,"_blank"):c.warning("翻译视频不存在")},ye=async e=>{if(e.translated_video_url)try{e.downloading=!0,c.info("正在准备下载...");const t=await j.downloadVideo(e.id);if(t instanceof Blob){const u=window.URL.createObjectURL(t),w=document.createElement("a");w.href=u;const S=e.original_filename||e.filename||"translated_video.mp4",Se=S.endsWith(".mp4")?S:`${S}.mp4`;w.download=Se,document.body.appendChild(w),w.click(),document.body.removeChild(w),window.URL.revokeObjectURL(u),c.success("视频下载已开始")}else throw new Error("下载响应格式错误")}catch(t){console.error("下载失败:",t),c.error("下载失败，请重试")}finally{e.downloading=!1}else c.warning("翻译视频不存在")},he=async e=>{try{await ie.confirm("确定要重新生成这个视频吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t={video_id:e.id,source_language:e.source_language,target_language:e.target_language,lipsync_enabled:e.lipsync_enabled,speaker_num:0},u=await j.startTranslate(t);u.code===200?(c.success("重新生成任务已启动!"),C()):c.error(u.message||"重新生成失败")}catch(t){t!=="cancel"&&(console.error("Renew video error:",t),c.error("重新生成失败"))}},be=e=>{T.value={id:e.id,name:e.filename,url:e.video_url,size:e.file_size},_.video_id=e.id,_.source_language=e.source_language,_.target_languages=e.target_language?[e.target_language]:[],_.lipsync_enabled=e.lipsync_enabled,_.speaker_num=0,te()},we=async e=>{try{await ie.confirm("确定要删除这个视频吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=await j.deleteVideo(e.id);t.code===200?(c.success("删除成功!"),C()):c.error(t.message||"删除失败")}catch(t){t!=="cancel"&&(console.error("Delete video error:",t),c.error("删除失败"))}},re=async e=>{if(!e.akool_task_id){c.warning("无法获取任务状态，缺少任务ID");return}try{e.refreshing=!0;const t=await j.getVideoStatus(e.id);if(t.code===200){const u=t.data;Object.assign(e,u),c.success("状态已更新"),(u.status==="completed"||u.status==="failed")&&C()}else c.error("获取状态失败")}catch(t){console.error("刷新状态失败:",t),c.error("刷新状态失败")}finally{e.refreshing=!1}},Ve=e=>{x.value=e,C()},ke=e=>{const t=h.value.find(u=>u.lang_code===e);return t?t.lang_name:e},Fe=e=>({uploaded:"info",processing:"warning",completed:"success",failed:"danger",expired:"info"})[e]||"info",xe=e=>({uploaded:"已上传",processing:"处理中",completed:"已完成",failed:"已失败",expired:"已过期"})[e]||e,Le=e=>({completed:"status-completed",expired:"status-expired",processing:"status-processing",failed:"status-failed"})[e]||"",ze=e=>e?new Date(e).toLocaleString("zh-CN"):"";let q=null;const ae=()=>{q&&clearInterval(q);const e=N.value.filter(t=>t.status==="processing");e.length>0&&(console.log(`发现 ${e.length} 个处理中的视频，启动自动刷新`),q=setInterval(async()=>{try{for(const u of e)u.status==="processing"&&u.akool_task_id&&(console.log(`自动刷新视频 ${u.id} 状态`),await re(u));await C(),N.value.filter(u=>u.status==="processing").length===0&&(console.log("所有视频处理完成，停止自动刷新"),le())}catch(t){console.error("自动刷新失败:",t)}},2e4))},le=()=>{q&&(clearInterval(q),q=null,console.log("自动刷新已停止"))};return Be(()=>{ne(),C(),setTimeout(()=>{ae()},2e3)}),Ce(()=>{le()}),{uploadRef:o,currentVideo:T,fileListShow:a,loading:H,isTranslating:I,videoList:N,languages:h,statusFilter:p,currentPage:x,pageSize:L,total:K,upload_url:l,video_accepts:E,translateForm:_,translateRules:X,translateFormRef:G,translateDialogVisible:W,canStartTranslate:J,availableVoices:z,selectedVoice:Q,showVoiceSelection:O,voiceMap:M,languageVoices:U,languageVoicesLoading:P,terminologies:B,styleOptions:F,beforeUpload:Y,uploadSuccess:Z,uploadError:$,handleExceed:i,handleFileChange:de,delUploadFile:ce,resetForm:ee,openTranslateDialog:te,startTranslate:ge,loadVideoList:C,loadLanguages:ne,loadVoices:se,handleTargetLanguagesChange:_e,handleVoiceChangeForLanguage:me,getVoicesForLanguage:fe,loadTerminologies:oe,handleTerminologyVisible:ve,previewVideo:pe,downloadVideo:ye,renewVideo:he,editVideo:be,deleteVideo:we,refreshVideoStatus:re,startAutoRefresh:ae,stopAutoRefresh:le,handlePageChange:Ve,getLanguageName:ke,getStatusType:Fe,getStatusText:xe,getStatusClass:Le,formatFileSize:ue,formatDate:ze,userStore:y}}},Ie={class:"page-center"},Ne={class:"container"},Oe={class:"upload-container"},Pe={class:"left_box pc_show"},qe={key:0,class:"icon_box"},Ke={class:"right_box"},We={key:0,class:"file-count-tip success"},Ge={key:0,class:"generate-container"},Je={class:"video-preview"},He={class:"video-frame"},Qe={class:"video-info"},Xe={class:"video-name"},Ye={class:"video-size"},Ze={class:"action-buttons"},$e={class:"list_box"},ea={class:"title_box"},aa={class:"filter-box"},la={class:"filename-cell"},oa={class:"status-info"},ta={key:0,class:"expiry-warning"},na={class:"pagination-box"},sa={class:"voice-selection-container"},ra={class:"voice-selection-label"},ia={class:"voice-loading-empty"},da={key:0,class:"el-icon-loading"},ca={key:1},ua={key:2},ga={class:"voice-option"},_a={class:"voice-info"},ma={class:"voice-name"},fa={class:"voice-gender"},va={class:"voice-details"},pa={class:"voice-language"},ya={key:0,class:"voice-style"},ha={key:0,class:"voice-preview"},ba={class:"voice-preview-info"},wa=["src"],Va={class:"voice-details"},ka={class:"voice-tags"},Fa={key:0,class:"voice-preview-audio"},xa=["src"],La={class:"terminology-option"},za={class:"terminology-title"},Sa={class:"terminology-count"},Ta={class:"form-tip",style:{color:"#909399","font-size":"12px"}},Ma={class:"dialog-footer"};function Ua(y,o,T,a,H,I){const N=V("el-upload"),h=V("el-button"),p=V("el-option"),x=V("el-select"),L=V("el-table-column"),K=V("el-tag"),W=V("el-table"),G=V("el-pagination"),z=V("el-form-item"),Q=V("el-switch"),O=V("el-radio"),M=V("el-radio-group"),U=V("el-form"),P=V("el-dialog"),B=De("loading");return d(),m("div",Ie,[n("div",Ne,[n("div",Oe,[r(N,{ref:"uploadRef",class:"dropzone",drag:"",action:a.upload_url,accept:a.video_accepts,"auto-upload":"",limit:1,"on-success":a.uploadSuccess,"on-error":a.uploadError,"on-exceed":a.handleExceed,headers:{Authorization:"Bearer "+a.userStore.token},"before-upload":a.beforeUpload,"before-remove":a.delUploadFile,"on-change":a.handleFileChange},{default:s(()=>[n("div",Pe,[a.fileListShow?b("",!0):(d(),m("div",qe,o[10]||(o[10]=[n("i",{class:"el-icon-video-camera",style:{"font-size":"48px",color:"#409EFF"}},null,-1)])))]),n("div",Ke,[o[11]||(o[11]=n("div",{class:"title pc_show"},"拖入/点击按钮选择视频文件",-1)),o[12]||(o[12]=n("button",{class:"upload_btn",type:"button"},[n("i",{class:"el-icon-upload",style:{"margin-right":"8px"}}),n("span",null,"上传视频")],-1)),o[13]||(o[13]=n("div",{class:"title phone_show"},"点击按钮选择视频文件",-1)),o[14]||(o[14]=n("div",{class:"tips"},"支持格式：MP4、AVI、MOV、WMV、FLV、MKV、WEBM，建议文件≤300MB",-1)),a.currentVideo?(d(),m("div",We," 已选择："+g(a.currentVideo.name),1)):b("",!0)])]),_:1},8,["action","accept","on-success","on-error","on-exceed","headers","before-upload","before-remove","on-change"])]),a.currentVideo?(d(),m("div",Ge,[n("div",Je,[n("div",He,[o[15]||(o[15]=n("i",{class:"el-icon-video-camera",style:{"font-size":"48px",color:"#409EFF"}},null,-1)),n("div",Qe,[n("div",Xe,g(a.currentVideo.name),1),n("div",Ye,g(a.formatFileSize(a.currentVideo.size)),1)])]),n("div",Ze,[r(h,{type:"primary",size:"large",class:"generate-btn",onClick:a.openTranslateDialog},{default:s(()=>o[16]||(o[16]=[n("i",{class:"el-icon-magic-stick",style:{"margin-right":"8px"}},null,-1),v(" 生成翻译 > ",-1)])),_:1,__:[16]},8,["onClick"])])])])):b("",!0),n("div",$e,[n("div",ea,[o[18]||(o[18]=n("h3",null,"视频翻译记录",-1)),n("div",aa,[r(x,{modelValue:a.statusFilter,"onUpdate:modelValue":o[0]||(o[0]=l=>a.statusFilter=l),placeholder:"筛选状态",onChange:a.loadVideoList,style:{width:"150px"}},{default:s(()=>[r(p,{label:"全部",value:""}),r(p,{label:"已上传",value:"uploaded"}),r(p,{label:"处理中",value:"processing"}),r(p,{label:"已完成",value:"completed"}),r(p,{label:"已失败",value:"failed"}),r(p,{label:"已过期",value:"expired"})]),_:1},8,["modelValue","onChange"]),r(h,{type:"primary",onClick:a.loadVideoList,loading:a.loading},{default:s(()=>o[17]||(o[17]=[n("i",{class:"el-icon-refresh"},null,-1),v(" 刷新 ",-1)])),_:1,__:[17]},8,["onClick","loading"])])]),Re((d(),k(W,{data:a.videoList,class:"video-table"},{default:s(()=>[r(L,{prop:"original_filename",label:"文件名","min-width":"250"},{default:s(l=>[n("div",la,[o[19]||(o[19]=n("i",{class:"el-icon-video-camera",style:{"margin-right":"8px",color:"#409EFF"}},null,-1)),v(" "+g(l.row.original_filename||l.row.filename),1)])]),_:1}),r(L,{prop:"source_language",label:"源语言",width:"120"},{default:s(l=>[v(g(a.getLanguageName(l.row.source_language)),1)]),_:1}),r(L,{prop:"target_language",label:"目标语言",width:"180"},{default:s(l=>[v(g(a.getLanguageName(l.row.target_language)),1)]),_:1}),r(L,{prop:"status",label:"状态",width:"120"},{default:s(l=>[r(K,{type:a.getStatusType(l.row.status)},{default:s(()=>[v(g(a.getStatusText(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),r(L,{prop:"status_info",label:"状态信息","min-width":"250"},{default:s(l=>{var E,_,F;return[n("div",oa,[n("span",{class:Ae(a.getStatusClass((E=l.row.status_info)==null?void 0:E.status))},g((_=l.row.status_info)==null?void 0:_.message),3),(F=l.row.status_info)!=null&&F.days_left?(d(),m("span",ta," ⏰ "+g(l.row.status_info.days_left)+"天后过期 ",1)):b("",!0)])]}),_:1}),r(L,{prop:"file_size",label:"文件大小",width:"120"},{default:s(l=>[v(g(a.formatFileSize(l.row.file_size)),1)]),_:1}),r(L,{prop:"created_at",label:"创建时间",width:"180"},{default:s(l=>[v(g(a.formatDate(l.row.created_at)),1)]),_:1}),r(L,{label:"操作",width:"280",fixed:"right"},{default:s(l=>{var E,_;return[(E=l.row.status_info)!=null&&E.can_download?(d(),k(h,{key:0,type:"success",size:"mini",onClick:F=>a.previewVideo(l.row)},{default:s(()=>o[20]||(o[20]=[v(" 预览 ",-1)])),_:2,__:[20]},1032,["onClick"])):b("",!0),(_=l.row.status_info)!=null&&_.can_download?(d(),k(h,{key:1,type:"primary",size:"mini",loading:l.row.downloading,onClick:F=>a.downloadVideo(l.row)},{default:s(()=>o[21]||(o[21]=[v(" 下载 ",-1)])),_:2,__:[21]},1032,["loading","onClick"])):b("",!0),l.row.status==="expired"?(d(),k(h,{key:2,type:"warning",size:"mini",onClick:F=>a.renewVideo(l.row)},{default:s(()=>o[22]||(o[22]=[v(" 重新生成 ",-1)])),_:2,__:[22]},1032,["onClick"])):b("",!0),l.row.status==="uploaded"?(d(),k(h,{key:3,type:"success",size:"mini",onClick:F=>a.editVideo(l.row)},{default:s(()=>o[23]||(o[23]=[v(" 编辑 ",-1)])),_:2,__:[23]},1032,["onClick"])):b("",!0),l.row.status==="processing"?(d(),k(h,{key:4,type:"warning",size:"mini",loading:l.row.refreshing,onClick:F=>a.refreshVideoStatus(l.row)},{default:s(()=>o[24]||(o[24]=[v(" 刷新状态 ",-1)])),_:2,__:[24]},1032,["loading","onClick"])):b("",!0),r(h,{type:"danger",size:"mini",onClick:F=>a.deleteVideo(l.row)},{default:s(()=>o[25]||(o[25]=[v(" 删除 ",-1)])),_:2,__:[25]},1032,["onClick"])]}),_:1})]),_:1},8,["data"])),[[B,a.loading]]),n("div",na,[r(G,{onCurrentChange:a.handlePageChange,"current-page":a.currentPage,"page-size":a.pageSize,total:a.total,layout:"total, prev, pager, next, jumper"},null,8,["onCurrentChange","current-page","page-size","total"])])])]),r(P,{title:"生成翻译",modelValue:a.translateDialogVisible,"onUpdate:modelValue":o[9]||(o[9]=l=>a.translateDialogVisible=l),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:s(()=>[n("div",Ma,[r(h,{onClick:o[8]||(o[8]=l=>a.translateDialogVisible=!1)},{default:s(()=>o[34]||(o[34]=[v("取消",-1)])),_:1,__:[34]}),r(h,{type:"primary",onClick:a.startTranslate,loading:a.isTranslating,disabled:a.isTranslating},{default:s(()=>o[35]||(o[35]=[v(" 翻译 ",-1)])),_:1,__:[35]},8,["onClick","loading","disabled"])])]),default:s(()=>[r(U,{model:a.translateForm,rules:a.translateRules,ref:"translateFormRef","label-width":"120px"},{default:s(()=>[r(z,{label:"源语言",prop:"source_language"},{default:s(()=>[r(x,{modelValue:a.translateForm.source_language,"onUpdate:modelValue":o[1]||(o[1]=l=>a.translateForm.source_language=l),placeholder:"请选择源语言",style:{width:"100%"}},{default:s(()=>[r(p,{label:"自动检测",value:"auto"}),(d(!0),m(R,null,A(a.languages,l=>(d(),k(p,{key:l.lang_code,label:l.lang_name,value:l.lang_code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(z,{label:"目标语言",prop:"target_languages"},{default:s(()=>[r(x,{modelValue:a.translateForm.target_languages,"onUpdate:modelValue":o[2]||(o[2]=l=>a.translateForm.target_languages=l),placeholder:"请选择目标语言（支持多选）",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",style:{width:"100%"},onChange:a.handleTargetLanguagesChange},{default:s(()=>[(d(!0),m(R,null,A(a.languages,l=>(d(),k(p,{key:l.lang_code,label:l.lang_name,value:l.lang_code},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),o[26]||(o[26]=n("div",{class:"form-tip"},"支持同时选择多个目标语言进行翻译",-1))]),_:1,__:[26]}),a.translateForm.target_languages&&a.translateForm.target_languages.length>0?(d(),k(z,{key:0,label:"AI语音"},{default:s(()=>[n("div",sa,[(d(!0),m(R,null,A(a.translateForm.target_languages,l=>{var E,_,F,X,J,Y,Z,$;return d(),m("div",{key:l,class:"voice-selection-item"},[n("div",ra,[n("span",null,g(a.getLanguageName(l)),1)]),r(x,{modelValue:a.voiceMap[l],"onUpdate:modelValue":i=>a.voiceMap[l]=i,placeholder:a.languageVoicesLoading[l]?"正在加载语音列表...":`请为 ${a.getLanguageName(l)} 选择AI语音（可选）`,clearable:"",loading:a.languageVoicesLoading[l],style:{width:"100%"},onChange:i=>a.handleVoiceChangeForLanguage(l,i)},{empty:s(()=>[n("div",ia,[a.languageVoicesLoading[l]?(d(),m("i",da)):b("",!0),a.languageVoicesLoading[l]?(d(),m("span",ca,"正在加载语音列表...")):(d(),m("span",ua,"暂无可用语音"))])]),default:s(()=>[(d(!0),m(R,null,A(a.getVoicesForLanguage(l),i=>(d(),k(p,{key:i.voice_id,label:`${i.name} (${i.gender})`,value:i.voice_id},{default:s(()=>[n("div",ga,[n("div",_a,[n("span",ma,g(i.name),1),n("span",fa,g(i.gender),1)]),n("div",va,[n("span",pa,g(i.language),1),i.style&&i.style.length?(d(),m("span",ya,g(i.style.join(", ")),1)):b("",!0)])])]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","loading","onChange"]),a.voiceMap[l]?(d(),m("div",ha,[n("div",ba,[(E=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))!=null&&E.thumbnailUrl?(d(),m("img",{key:0,src:(_=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))==null?void 0:_.thumbnailUrl,class:"voice-avatar"},null,8,wa)):b("",!0),n("div",Va,[n("h4",null,g((F=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))==null?void 0:F.name),1),n("p",null,g((X=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))==null?void 0:X.language)+" • "+g((J=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))==null?void 0:J.gender),1),n("div",ka,[(d(!0),m(R,null,A((Y=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))==null?void 0:Y.style,i=>(d(),k(K,{key:i,size:"small",style:{"margin-right":"4px"}},{default:s(()=>[v(g(i),1)]),_:2},1024))),128))])])]),(Z=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))!=null&&Z.preview?(d(),m("div",Fa,[n("audio",{controls:"",src:($=a.getVoicesForLanguage(l).find(i=>i.voice_id===a.voiceMap[l]))==null?void 0:$.preview,class:"preview-audio"},null,8,xa)])):b("",!0)])):b("",!0)])}),128))]),o[27]||(o[27]=n("div",{class:"form-tip"},"为每个目标语言单独选择AI语音，不选择则使用默认语音",-1))]),_:1,__:[27]})):b("",!0),r(z,{label:"Lip Sync"},{default:s(()=>[r(Q,{modelValue:a.translateForm.lipsync_enabled,"onUpdate:modelValue":o[3]||(o[3]=l=>a.translateForm.lipsync_enabled=l),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),o[28]||(o[28]=n("i",{class:"el-icon-info",style:{"margin-left":"8px",color:"#909399"}},null,-1))]),_:1,__:[28]}),a.translateForm.lipsync_enabled?(d(),k(z,{key:1,label:"唇语同步类型"},{default:s(()=>[r(M,{modelValue:a.translateForm.lip_sync_type,"onUpdate:modelValue":o[4]||(o[4]=l=>a.translateForm.lip_sync_type=l)},{default:s(()=>[r(O,{label:0},{default:s(()=>o[29]||(o[29]=[v("标准",-1)])),_:1,__:[29]}),r(O,{label:1},{default:s(()=>o[30]||(o[30]=[v("增强",-1)])),_:1,__:[30]}),r(O,{label:2},{default:s(()=>o[31]||(o[31]=[v("专业",-1)])),_:1,__:[31]})]),_:1},8,["modelValue"])]),_:1})):b("",!0),r(z,{label:"术语库"},{default:s(()=>[r(x,{modelValue:a.translateForm.terminology_ids,"onUpdate:modelValue":o[5]||(o[5]=l=>a.translateForm.terminology_ids=l),placeholder:"请选择术语库（可选，可多选）",multiple:"",clearable:"",filterable:"",style:{width:"100%"},onFocus:a.loadTerminologies,onVisibleChange:a.handleTerminologyVisible},{default:s(()=>[(d(!0),m(R,null,A(a.terminologies,l=>(d(),k(p,{key:l.id,label:l.title,value:l.id},{default:s(()=>[n("div",La,[n("span",za,g(l.title),1),n("span",Sa,"("+g(l.term_count||0)+"条术语)",1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onFocus","onVisibleChange"]),o[32]||(o[32]=n("div",{class:"form-tip"},"选择术语库可以提高翻译的专业性和准确性",-1)),n("div",Ta," 当前加载了 "+g(a.terminologies.length)+" 个术语库 ",1)]),_:1,__:[32]}),r(z,{label:"发言者人数"},{default:s(()=>[r(x,{modelValue:a.translateForm.speaker_num,"onUpdate:modelValue":o[6]||(o[6]=l=>a.translateForm.speaker_num=l),placeholder:"自动检测",style:{width:"100%"}},{default:s(()=>[r(p,{label:"自动检测",value:0}),(d(),m(R,null,A([1,2,3,4,5],l=>r(p,{key:l,label:`${l}人`,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),r(z,{label:"翻译风格"},{default:s(()=>[r(x,{modelValue:a.translateForm.style,"onUpdate:modelValue":o[7]||(o[7]=l=>a.translateForm.style=l),placeholder:"请选择翻译风格",style:{width:"100%"}},{default:s(()=>[(d(!0),m(R,null,A(a.styleOptions,l=>(d(),k(p,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o[33]||(o[33]=n("div",{class:"form-tip"},"选择翻译风格，影响语音的情感表达",-1))]),_:1,__:[33]})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}const Ba=Te(je,[["render",Ua],["__scopeId","data-v-d09497c9"]]);export{Ba as default};
