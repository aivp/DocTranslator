import{_ as C,u as E,z as A,r as m,e as v,O as F,f as U,i as r,o as w,c as D,a as u,al as O,k as o,w as t,am as P,n as L,m as B,x as I,t as R,an as q,E as V}from"./index-2f4_gmLj.js";const G={class:"auth-page"},S={class:"auth-container"},z={__name:"index",setup(K){const b=E(),h=A(),p=m("login"),f=m(null),d=m(!1);let n="";try{window.__APP_CONFIG__&&window.__APP_CONFIG__.DEFAULT_TENANT_CODE&&(n=window.__APP_CONFIG__.DEFAULT_TENANT_CODE)}catch(l){console.warn("无法读取运行时配置:",l)}n||(n="TENANT_0001");const c=v(()=>!!n),a=F({email:"",password:"",tenant_code:n}),y=v(()=>{const l={email:[{required:!0,message:"请填写邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}]};return c.value||(l.tenant_code=[{required:!0,message:"请填写租户代码",trigger:"blur"}]),l});U(()=>{c.value&&(a.tenant_code=n)});const g=async()=>{f.value.validate(async l=>{if(l){d.value=!0;try{const e=await q(a);e.code===200?(b.updateToken(e.data.token),h.push({name:"home"})):V.error(e.message)}catch(e){console.error("登录失败:",e)}finally{d.value=!1}}else V.error("请正确填写表单")})};return(l,e)=>{const _=r("el-input"),i=r("el-form-item"),N=r("el-button"),T=r("el-form"),x=r("el-tab-pane"),k=r("el-tabs");return w(),D("div",G,[u("div",S,[e[4]||(e[4]=u("div",{class:"auth-header"},[u("img",{src:O,alt:"Logo",class:"auth-logo"}),u("h1",{class:"auth-title"},"欢迎回来"),u("p",{class:"auth-subtitle"},"请登录以继续")],-1)),o(k,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value=s),stretch:"",class:"auth-tabs"},{default:t(()=>[o(x,{label:"登录",name:"login"},{default:t(()=>[o(T,{model:a,ref_key:"loginFormRef",ref:f,rules:y.value,onKeyup:P(g,["enter"])},{default:t(()=>[o(i,{prop:"email"},{default:t(()=>[o(_,{modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=s=>a.email=s),placeholder:"邮箱","prefix-icon":"el-icon-message"},null,8,["modelValue"])]),_:1}),o(i,{prop:"password"},{default:t(()=>[o(_,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=s=>a.password=s),type:"password","show-password":"",placeholder:"密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),c.value?B("",!0):(w(),L(i,{key:0,prop:"tenant_code"},{default:t(()=>[o(_,{modelValue:a.tenant_code,"onUpdate:modelValue":e[2]||(e[2]=s=>a.tenant_code=s),placeholder:"租户代码","prefix-icon":"el-icon-office-building"},null,8,["modelValue"])]),_:1})),o(i,{class:"center"},{default:t(()=>[o(N,{type:"primary",size:"large",class:"auth-btn",onClick:g,loading:d.value},{default:t(()=>[I(R(d.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])])])}}},j=C(z,[["__scopeId","data-v-0d3647ec"]]);export{j as default};
