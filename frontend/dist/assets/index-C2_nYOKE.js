import{_ as ve}from"./nodata-CSuNOf8O.js";/* empty css                                                               */import{_ as pe,r as g,P as Ce,i as _,j as be,o as f,c as x,k as t,w as o,a as n,t as U,y as v,F as le,q as se,n as I,l as ye,Q as Ve,p as he,m as W,N as ee,E as i,v as me,R as $e,u as Te,f as Ue,S as Le,T as qe,U as Ne,V as Re,W as Se,X as Ee,x as fe,Y as ze,Z as Fe,$ as Be,a0 as Ye}from"./index-CnQxGHSk.js";const De={class:"flag_tips"},Oe={class:"terms_section"},Ie={class:"terms_header"},Pe={class:"search_box"},je={class:"terms_table"},Je={class:"action-buttons"},Ae={key:0,class:"pagination_box"},Me={class:"btn_box"},Xe={class:"btn_box"},He={__name:"TermEdit",props:{langs:Array,loading:Boolean},emits:["update:modelValue","confirm","refresh"],setup(X,{expose:P,emit:Z}){const w=g(null),S=g([]),E=g(!1),y=g(""),m=g(1),V=g(10),b=g(0),h=g(!1),z=g(!1),L=g(null),u=g({id:"",original:"",comparison_text:""}),$=g(!1),k=g(!1),Y={original:[{required:!0,message:"请输入原文",trigger:"blur"}],comparison_text:[{required:!0,message:"请输入对应术语",trigger:"blur"}]};let F=null;const G=()=>{F&&clearTimeout(F),F=setTimeout(()=>{m.value=1,R()},500)},H=s=>{V.value=s,m.value=1,R()},j=s=>{m.value=s,R()},R=async()=>{if(console.log("fetchTermsList 被调用，ID:",d.value.id),!d.value.id){console.log("没有ID，退出获取术语列表");return}E.value=!0;try{const s={page:m.value,limit:V.value};y.value.trim()&&(s.search=y.value.trim());const r=`/comparison/${d.value.id}/terms?${new URLSearchParams(s)}`;console.log("请求URL:",r);const q=await ee({url:`/comparison/${d.value.id}/terms`,method:"get",params:s});console.log("响应状态:",q.code),q.code===200?(S.value=q.data.data,b.value=q.data.total,console.log("术语列表设置成功，数量:",S.value.length,"总数:",b.value)):i.error(q.message||"获取术语列表失败")}catch(s){console.error("获取术语列表失败:",s),i.error("获取术语列表失败")}finally{E.value=!1}},C=(s,r,q)=>{w.value.clearValidate(["origin_lang","target_lang"]),d.value.origin_lang!=""&&d.value.target_lang!=""&&d.value.origin_lang==d.value.target_lang?q(new Error("源语种与对照语种不能一样")):q()},te={title:[{required:!0,message:"请填写术语标题",trigger:["blur","change"]}],origin_lang:[{required:!0,message:"请选择源语种",trigger:["blur","change"]},{validator:C,trigger:["blur","change"]}],target_lang:[{required:!0,message:"请选择对照语种",trigger:["blur","change"]},{validator:C,trigger:["blur","change"]}]},D=X,B=g(!1),d=g({id:"",title:"",origin_lang:"",target_lang:"",share_flag:"N"});Ce(B,s=>{console.log("visible 变化:",s,"localForm.id:",d.value.id),s&&d.value.id?(console.log("准备获取术语列表，ID:",d.value.id),$e(()=>{R()})):s&&!d.value.id?console.log("新建术语库模式，不获取术语列表"):console.log("弹窗关闭")});const J=Z,ne=s=>{console.log("TermEdit open 被调用，接收到的数据:",s);const r=s||{};d.value={id:"",title:"",origin_lang:"",target_lang:"",share_flag:"N",...r},console.log("localForm 设置后的值:",d.value),B.value=!0},oe=()=>{B.value=!1,S.value=[],y.value="",m.value=1,b.value=0,J("refresh")},re=async()=>{try{await w.value.validate(),J("confirm",d.value),oe()}catch(s){console.error("表单验证失败:",s)}};P({open:ne});const l=s=>{u.value={id:s.id,original:s.original,comparison_text:s.comparison_text},h.value=!0},e=async()=>{if(!k.value){k.value=!0;try{if(d.value.id)u.value={id:"",original:"",comparison_text:""},h.value=!0;else{if(!d.value.title||!d.value.origin_lang||!d.value.target_lang){i.warning("请先填写术语表标题、源语种和对照语种，然后保存术语库");return}try{$.value=!0,i.info("正在保存术语库，请稍候...");const s=await ee({url:"/comparison",method:"post",data:{title:d.value.title,origin_lang:d.value.origin_lang,target_lang:d.value.target_lang,share_flag:d.value.share_flag}});s.code===200?(d.value.id=s.data.id,i.success("术语库保存成功，现在可以新增术语了"),u.value={id:"",original:"",comparison_text:""},h.value=!0):i.error(s.message||"保存术语库失败")}catch(s){console.error("保存术语库失败:",s),i.error("保存术语库失败")}finally{$.value=!1}}}finally{k.value=!1}}},a=async()=>{try{if(await L.value.validate(),z.value=!0,u.value.id){const s=await ee({url:`/comparison/term/${u.value.id}`,method:"put",data:{original:u.value.original,comparison_text:u.value.comparison_text}});s.code===200?(i.success("编辑成功"),h.value=!1,R(),J("refresh")):i.error(s.message||"编辑失败")}else{if(!d.value.id){i.error("术语库未保存，无法新增术语");return}const s=await ee({url:`/comparison/${d.value.id}/terms`,method:"post",data:{original:u.value.original,comparison_text:u.value.comparison_text}});s.code===200?(i.success("新增成功"),h.value=!1,R(),J("refresh")):i.error(s.message||"新增失败")}}catch(s){console.error("操作术语失败:",s),i.error("操作术语失败")}finally{z.value=!1}},N=s=>{me.confirm(`确定要删除这条术语记录吗？
原文：${s.original}
对应术语：${s.comparison_text}`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!1}).then(async()=>{try{const r=await ee({url:`/comparison/term/${s.id}`,method:"delete"});r.code===200?(i.success("删除成功"),R(),J("refresh")):i.error(r.message||"删除失败")}catch(r){console.error("删除术语失败:",r),i.error("删除术语失败")}}).catch(()=>{})};return(s,r)=>{const q=_("el-switch"),K=_("el-input"),O=_("el-form-item"),Q=_("el-col"),ae=_("el-option"),c=_("el-select"),A=_("el-row"),T=_("el-icon"),M=_("el-button"),ie=_("el-table-column"),xe=_("el-table"),we=_("el-pagination"),_e=_("el-form"),ge=_("el-dialog"),ke=be("loading");return f(),x(le,null,[t(ge,{modelValue:B.value,"onUpdate:modelValue":r[7]||(r[7]=p=>B.value=p),title:"术语编辑器",width:"75%",fullscreen:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":"",class:"term_dialog"},{header:o(({close:p,titleId:ue,titleClass:de})=>[r[12]||(r[12]=n("span",{class:"title"},"术语编辑器",-1)),t(q,{modelValue:d.value.share_flag,"onUpdate:modelValue":r[0]||(r[0]=ce=>d.value.share_flag=ce),"active-value":"Y","inactive-value":"N"},null,8,["modelValue"]),n("div",De,"共享"+U(d.value.share_flag=="Y"?"开启":"关闭"),1)]),footer:o(()=>[n("div",Me,[t(M,{type:"primary",color:"#055CF9",disabled:D.loading||$.value,loading:D.loading||$.value,onClick:re},{default:o(()=>[v(U(D.loading||$.value?"保存术语库中...":"保存"),1)]),_:1},8,["disabled","loading"]),t(M,{onClick:oe},{default:o(()=>r[16]||(r[16]=[v("关闭",-1)])),_:1,__:[16]})])]),default:o(()=>[t(_e,{ref_key:"termformRef",ref:w,model:d.value,rules:te,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[t(A,{gutter:20},{default:o(()=>[t(Q,{span:24},{default:o(()=>[t(O,{label:"术语表标题",required:"",prop:"title",width:"100%"},{default:o(()=>[t(K,{modelValue:d.value.title,"onUpdate:modelValue":r[1]||(r[1]=p=>d.value.title=p),type:"text",placeholder:"请输入术语表标题",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),t(Q,{xs:24,sm:12},{default:o(()=>[t(O,{label:"源语种",required:"",prop:"origin_lang",width:"100%"},{default:o(()=>[t(c,{modelValue:d.value.origin_lang,"onUpdate:modelValue":r[2]||(r[2]=p=>d.value.origin_lang=p),placeholder:"请选择",filterable:"","allow-create":"",clearable:""},{default:o(()=>[(f(!0),x(le,null,se(D.langs,p=>(f(),I(ae,{key:p,name:p,value:p},null,8,["name","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(Q,{xs:24,sm:12},{default:o(()=>[t(O,{label:"对照语种",required:"",prop:"target_lang",width:"100%"},{default:o(()=>[t(c,{modelValue:d.value.target_lang,"onUpdate:modelValue":r[3]||(r[3]=p=>d.value.target_lang=p),placeholder:"请选择",filterable:"","allow-create":"",clearable:""},{default:o(()=>[(f(!0),x(le,null,se(D.langs,p=>(f(),I(ae,{key:p,name:p,value:p},null,8,["name","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n("div",Oe,[n("div",Ie,[r[13]||(r[13]=n("h3",null,"术语列表",-1)),n("div",Pe,[t(K,{modelValue:y.value,"onUpdate:modelValue":r[4]||(r[4]=p=>y.value=p),placeholder:"搜索术语...",clearable:"",onInput:G,style:{width:"300px"}},{prefix:o(()=>[t(T,null,{default:o(()=>[t(ye(Ve))]),_:1})]),_:1},8,["modelValue"]),t(M,{type:"primary",loading:k.value,disabled:k.value,onClick:e,style:{"margin-left":"12px"}},{default:o(()=>[v(U(k.value?"处理中...":"新增术语"),1)]),_:1},8,["loading","disabled"])])]),n("div",je,[he((f(),I(xe,{data:S.value,style:{width:"100%"},border:"",stripe:""},{default:o(()=>{var p,ue;return[t(ie,{prop:"original",label:((p=d.value.value)==null?void 0:p.origin_lang)||"源语种","min-width":"200","show-overflow-tooltip":""},null,8,["label"]),t(ie,{prop:"comparison_text",label:((ue=d.value.value)==null?void 0:ue.target_lang)||"对照语种","min-width":"200","show-overflow-tooltip":""},null,8,["label"]),t(ie,{label:"操作",width:"120",fixed:"right",align:"center"},{default:o(({row:de})=>[n("div",Je,[t(M,{type:"primary",size:"small",onClick:ce=>l(de),text:""},{default:o(()=>r[14]||(r[14]=[v(" 编辑 ",-1)])),_:2,__:[14]},1032,["onClick"]),t(M,{type:"danger",size:"small",onClick:ce=>N(de),text:""},{default:o(()=>r[15]||(r[15]=[v(" 删除 ",-1)])),_:2,__:[15]},1032,["onClick"])])]),_:1})]}),_:1},8,["data"])),[[ke,E.value]]),b.value>0?(f(),x("div",Ae,[t(we,{"current-page":m.value,"onUpdate:currentPage":r[5]||(r[5]=p=>m.value=p),"page-size":V.value,"onUpdate:pageSize":r[6]||(r[6]=p=>V.value=p),"page-sizes":[10,20,50],total:b.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:j},null,8,["current-page","page-size","total"])])):W("",!0)])])]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(ge,{modelValue:h.value,"onUpdate:modelValue":r[11]||(r[11]=p=>h.value=p),title:u.value.id?"编辑术语":"新增术语",width:"600px","destroy-on-close":""},{footer:o(()=>[n("div",Xe,[t(M,{onClick:r[10]||(r[10]=p=>h.value=!1)},{default:o(()=>r[17]||(r[17]=[v("取消",-1)])),_:1,__:[17]}),t(M,{type:"primary",color:"#055CF9",loading:z.value,onClick:a},{default:o(()=>[v(U(u.value.id?"确认":"保存"),1)]),_:1},8,["loading"])])]),default:o(()=>[t(_e,{ref_key:"editTermFormRef",ref:L,model:u.value,rules:Y,"label-width":"80px"},{default:o(()=>[t(O,{label:"原文",prop:"original"},{default:o(()=>[t(K,{modelValue:u.value.original,"onUpdate:modelValue":r[8]||(r[8]=p=>u.value.original=p),type:"textarea",rows:3,placeholder:"请输入原文"},null,8,["modelValue"])]),_:1}),t(O,{label:"对应术语",prop:"comparison_text"},{default:o(()=>[t(K,{modelValue:u.value.comparison_text,"onUpdate:modelValue":r[9]||(r[9]=p=>u.value.comparison_text=p),type:"textarea",rows:3,placeholder:"请输入对应术语"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}},Ke=pe(He,[["__scopeId","data-v-bf25fa3e"]]),Qe={class:"flag_tips"},We={class:"prompt-section"},Ze={class:"prompt-section"},Ge={class:"prompt-section"},el={class:"btn_box"},ll={__name:"PromptEdit",props:{loading:Boolean},emits:["confirm","close"],setup(X,{expose:P,emit:Z}){const w={title:[{required:!0,message:"请填写提示词标题",trigger:["blur","change"]}],role_content:[{required:!0,message:"请填写角色内容",trigger:["blur","change"]}],task_content:[{required:!0,message:"请填写任务内容",trigger:["blur","change"]}],requirements_content:[{required:!0,message:"请填写翻译要求",trigger:["blur","change"]}]},S=Z,E=g(null),y=g(!1),m=g({title:"",share_flag:"N",role_content:"",task_content:"",requirements_content:"",content:""}),V=()=>{y.value=!0},b=()=>{y.value=!1},h=()=>{E.value.validate(L=>{L&&(S("confirm",m.value),b())})};return P({open:V,close:b,updateForm:L=>{m.value=L},localForm:m}),(L,u)=>{const $=_("el-switch"),k=_("el-input"),Y=_("el-form-item"),F=_("el-col"),G=_("el-row"),H=_("el-form"),j=_("el-button"),R=_("el-dialog");return f(),I(R,{modelValue:y.value,"onUpdate:modelValue":u[5]||(u[5]=C=>y.value=C),"destroy-on-close":"",title:"提示词编辑器",width:"90%","modal-class":"term_dialog"},{header:o(({close:C,titleId:te,titleClass:D})=>[u[6]||(u[6]=n("span",{class:"title"},"提示词编辑器",-1)),t($,{modelValue:m.value.share_flag,"onUpdate:modelValue":u[0]||(u[0]=B=>m.value.share_flag=B),"active-value":"Y","inactive-value":"N"},null,8,["modelValue"]),n("div",Qe,"共享"+U(m.value.share_flag=="Y"?"开启":"关闭"),1)]),default:o(()=>[t(H,{ref_key:"promptformRef",ref:E,model:m.value,rules:w,"label-position":"top","hide-required-asterisk":"true"},{default:o(()=>[t(G,{gutter:20},{default:o(()=>[t(F,{span:24},{default:o(()=>[t(Y,{label:"提示词标题",required:"",prop:"title",width:"100%"},{default:o(()=>[t(k,{modelValue:m.value.title,"onUpdate:modelValue":u[1]||(u[1]=C=>m.value.title=C),type:"text",placeholder:"请输入提示词标题",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),t(F,{span:24},{default:o(()=>[t(Y,{label:"角色",required:"",prop:"role_content",width:"100%"},{default:o(()=>[n("div",We,[t(k,{modelValue:m.value.role_content,"onUpdate:modelValue":u[2]||(u[2]=C=>m.value.role_content=C),type:"textarea",rows:3,resize:"none",placeholder:"请输入翻译专家的角色描述"},null,8,["modelValue"]),u[7]||(u[7]=n("div",{class:"example-text"}," 示例：你是一名专业的法律翻译专家,精通中文和英文,尤其擅长处理商业合同和法律文件。 ",-1))])]),_:1})]),_:1}),t(F,{span:24},{default:o(()=>[t(Y,{label:"任务",required:"",prop:"task_content",width:"100%"},{default:o(()=>[n("div",Ze,[t(k,{modelValue:m.value.task_content,"onUpdate:modelValue":u[3]||(u[3]=C=>m.value.task_content=C),type:"textarea",rows:3,resize:"none",placeholder:"请输入具体的翻译任务"},null,8,["modelValue"]),u[8]||(u[8]=n("div",{class:"example-text"}," 示例：我需要你将以下中文法律文本翻译成专业、精准、正式的英文。 ",-1))])]),_:1})]),_:1}),t(F,{span:24},{default:o(()=>[t(Y,{label:"翻译要求",required:"",prop:"requirements_content",width:"100%"},{default:o(()=>[n("div",Ge,[t(k,{modelValue:m.value.requirements_content,"onUpdate:modelValue":u[4]||(u[4]=C=>m.value.requirements_content=C),type:"textarea",rows:5,resize:"none",placeholder:"请输入翻译的具体要求"},null,8,["modelValue"]),u[9]||(u[9]=n("div",{class:"example-text"},[v(" 示例："),n("br"),v(" 1. **忠实原文**：严格按照原文的含义和法律意图进行翻译,不得添加或删减信息。"),n("br"),v(" 2. **术语精准**：使用英美法系(Common law) 通用的标准法律术语。"),n("br"),v(" 3. **语气正式**：保持法律文件固有的严谨、客观和正式的语体。"),n("br"),v(" 4. **语句清晰**：译文必须清晰、无歧义,符合英文法律文书的表达习惯。"),n("br"),v(" 5. **格式保留**：保持原文的段落、编号和基本格式。 ")],-1))])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),n("div",el,[t(j,{disabled:X.loading,onClick:b},{default:o(()=>u[10]||(u[10]=[v("取消",-1)])),_:1,__:[10]},8,["disabled"]),t(j,{type:"primary",color:"#055CF9",disabled:X.loading,loading:X.loading,onClick:h},{default:o(()=>u[11]||(u[11]=[v(" 保存 ",-1)])),_:1,__:[11]},8,["disabled","loading"])])]),_:1},8,["modelValue"])}}},tl=pe(ll,[["__scopeId","data-v-0c2efab5"]]),ol={class:"page-center","element-loading-text":"loading...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.7)"},al={class:"container"},sl={class:"tab_box"},nl={key:0,class:"content_box"},rl={class:"flex_box flex-between phone_box"},il={key:0,class:"btn_box"},ul={key:1,class:"btn_box"},dl={key:0,class:"term_box"},cl={class:"term_li"},ml={class:"flex_box title_box flex-between"},pl=["title"],_l={class:"des"},gl={class:"term_count"},vl={class:"count_text"},fl={class:"btn_box flex_box flex-between"},bl={class:"left"},yl={class:"right"},hl={key:0,class:"table_box"},xl={key:1,class:"no_terms"},wl={key:1,class:"no_data"},kl={key:1,class:"prompt_box"},Cl={class:"term_li"},Vl={class:"flex_box title_box flex-between"},$l=["title"],Tl={key:0,class:"btn_box flex_box flex-between"},Ul={class:"left"},Ll={class:"right"},ql={key:1,class:"btn_box"},Nl={class:"text_box"},Rl={class:"text"},Sl={key:1,class:"no_data"},El={__name:"index",setup(X){const P=Te(),Z=g("/api/comparison/import"),w=g(!1),S=g([]),E=g([]),y=g(null),m=g(!1),V=g(null),b=g("terms"),h=g(!1),z=g(!1),L=g(!1);function u(l){b.value=l}const $=async()=>{w.value=!1;try{const l=await Le();l.code===200&&(S.value=l.data.data)}catch(l){console.error("获取术语表数据失败:",l)}w.value=!1},k=async()=>{w.value=!1;try{const l=await qe();l.code===200&&(E.value=JSON.parse(JSON.stringify(l.data.data)))}catch(l){console.error("获取提示词数据失败:",l)}w.value=!1},Y=["中文","英语","日语","俄语","阿拉伯语","西班牙语","韩语","德语"],F=l=>{const e=l;m.value=!0,e.id?Ne(e.id,e).then(a=>{m.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),V.value.close(),k()):i({message:a.message,type:"error"})}).catch(a=>{i({message:"接口异常",type:"error"})}):Re(e).then(a=>{m.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),V.value.close(),k()):i({message:a.message,type:"error"})}).catch(a=>{i({message:"接口异常",type:"error"})}),V.value.close(),m.value=!1},G=l=>{const e=l;console.log("保存术语表数据:",e),m.value=!0,e.id?(console.log("执行编辑操作，ID:",e.id),Se(e.id,e).then(a=>{console.log("编辑成功响应:",a),console.log("响应数据类型:",typeof a),console.log("响应数据键:",Object.keys(a||{})),m.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),$(),setTimeout(()=>{y.value&&y.value.close()},100)):i({message:a.message||"保存失败",type:"error"})}).catch(a=>{m.value=!1,console.error("编辑术语表失败:",a),i({message:"接口异常",type:"error"})})):(console.log("执行新建操作"),Ee(e).then(a=>{console.log("新建成功响应:",a),console.log("响应数据类型:",typeof a),console.log("响应数据键:",Object.keys(a||{})),m.value=!1,a.code==200?(i({message:"保存成功",type:"success"}),$(),setTimeout(()=>{y.value&&y.value.close()},100)):i({message:a.message||"保存失败",type:"error"})}).catch(a=>{m.value=!1,console.error("新建术语表失败:",a),i({message:"接口异常",type:"error"})}))};function H(l){l?y.value.open(l):y.value.open({title:"",share_flag:"N",origin_lang:"",target_lang:""})}function j(l){V.value.open(),l?V.value.updateForm(JSON.parse(JSON.stringify(l))):V.value.updateForm({title:"",share_flag:"N",content:""})}function R(l){me.confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=!0,ze(l.id).then(e=>{e.code==200?(i({message:"删除成功",type:"success"}),$()):i({message:e.message,type:"error"})})})}function C(l){w.value=!0,Fe(l.id,{share_flag:l.share_flag}).then(e=>{w.value=!1,e.code==200?i({message:"分享状态已更新",type:"success"}):(i({message:e.message,type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y")}).catch(e=>{i({message:"接口异常",type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y"})}async function te(l){try{z.value=!0;const e=await fetch(`/api/comparison/export/${l.id}`,{headers:{Authorization:`Bearer ${P.token}`}});if(!e.ok)throw new Error("文件下载失败");const a=await e.blob(),N=window.URL.createObjectURL(a),s=document.createElement("a");s.href=N,s.download=`${l.title}.xlsx`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(N),i({message:"导出成功",type:"success"})}catch(e){console.error("下载失败:",e),i.error("文件下载失败，请稍后重试")}finally{z.value=!1}}async function D(){try{L.value=!0;const l=await fetch("/api/comparison/export/all",{headers:{Authorization:`Bearer ${P.token}`}});if(!l.ok)throw new Error("术语表导出失败");const e=await l.blob(),a=window.URL.createObjectURL(e),N=document.createElement("a");N.href=a,N.download=`all_terms_${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(a),i({message:"批量导出成功",type:"success"})}catch(l){console.error("导出失败:",l),i.error("术语表导出失败，请稍后重试")}finally{L.value=!1}}function B(l){window.open("/api/comparison/template")}function d(l){console.log("上传成功"),console.log(l),h.value=!1,l.code==200?(i({message:"导入成功",type:"success"}),$()):i({message:l.message,type:"error"})}function J(l){console.log("上传失败"),console.log(l),h.value=!1;let e="导入失败";try{if(l.message){const a=JSON.parse(l.message);a.message&&(e=decodeURIComponent(JSON.stringify(a.message).replace(/\\u/g,"%u")))}}catch(a){console.error("解析错误响应失败:",a),l.message&&typeof l.message=="string"&&(e=l.message)}i({message:e,type:"error"})}function ne(l){const a=l.name.substring(l.name.lastIndexOf(".")+1)==="xlsx";return a?(h.value=!0,console.log("isXlsx",a),a):(i({message:"请上传模板格式的文件",type:"error"}),!1)}function oe(l){w.value=!0,l.id&&Be(l.id,{share_flag:l.share_flag}).then(e=>{w.value=!1,e.code==200?i({message:"分享状态已更新",type:"success"}):(i({message:e.message,type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y")}).catch(e=>{i({message:"接口异常",type:"error"}),l.share_flag=="Y"?l.share_flag="N":l.share_flag="Y"})}function re(l){me.confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=!0,Ye(l.id).then(e=>{e.code==200?(i({message:"删除成功",type:"success"}),k()):i({message:e.message,type:"error"})})})}return Ue(()=>{$(),k()}),(l,e)=>{const a=_("el-button"),N=_("el-button-group"),s=_("el-upload"),r=_("el-switch"),q=_("el-table-column"),K=_("el-table"),O=_("el-col"),Q=_("el-row"),ae=be("loading");return he((f(),x("div",ol,[n("div",al,[n("div",sl,[e[4]||(e[4]=n("div",{class:"tab_li actived"},"我的",-1)),n("div",{class:"tab_li",onClick:e[0]||(e[0]=c=>l.$router.push("/corpus/square"))},"广场")]),(f(),x("div",nl,[n("div",rl,[t(N,null,{default:o(()=>[t(a,{class:fe(b.value=="terms"?"btn_active":"my_button"),plain:b.value!="terms",type:b.value=="terms"?"primary":"",onClick:e[1]||(e[1]=c=>u("terms"))},{default:o(()=>e[5]||(e[5]=[v(" 我的术语表 ",-1)])),_:1,__:[5]},8,["class","plain","type"]),t(a,{class:fe(b.value=="prompt"?"btn_active":"my_button"),plain:b.value!="prompt",type:b.value=="prompt"?"primary":"",onClick:e[2]||(e[2]=c=>u("prompt"))},{default:o(()=>e[6]||(e[6]=[v(" 我的提示词 ",-1)])),_:1,__:[6]},8,["class","plain","type"])]),_:1}),b.value=="terms"?(f(),x("div",il,[t(a,{type:"primary",color:"#055CF9",onClick:H},{default:o(()=>e[7]||(e[7]=[v("新建",-1)])),_:1,__:[7]}),t(a,{type:"primary",style:{margin:"0 8px"},onClick:e[3]||(e[3]=c=>B())},{default:o(()=>e[8]||(e[8]=[v(" 模板下载 ",-1)])),_:1,__:[8]}),t(s,{name:"file","before-upload":ne,action:Z.value,headers:{Authorization:"Bearer "+ye(P).token},"show-file-list":!1,"on-success":(c,A,T)=>d(c),"on-error":(c,A,T)=>J(c),disabled:h.value,style:{display:"inline-block"}},{default:o(()=>[t(a,{type:"primary",loading:h.value,disabled:h.value},{default:o(()=>[v(U(h.value?"导入中...":"导入文件"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["action","headers","on-success","on-error","disabled"]),t(a,{type:"",onClick:D,loading:L.value,disabled:L.value},{default:o(()=>[v(U(L.value?"导出中...":"全部导出"),1)]),_:1},8,["loading","disabled"])])):W("",!0),b.value=="prompt"?(f(),x("div",ul,[t(a,{type:"primary",color:"#055CF9",onClick:j},{default:o(()=>e[9]||(e[9]=[v("新建",-1)])),_:1,__:[9]})])):W("",!0)]),b.value=="terms"?(f(),x("div",dl,[S.value.length>0?(f(),I(Q,{key:0,gutter:24},{default:o(()=>[(f(!0),x(le,null,se(S.value,(c,A)=>(f(),I(O,{xs:24,sm:8,key:A},{default:o(()=>[n("div",cl,[n("div",ml,[n("div",{class:"t",title:c.title},U(c.title),9,pl),n("div",_l,U(c.origin_lang)+"-"+U(c.target_lang),1)]),n("div",gl,[n("span",vl,"共 "+U(c.term_count||0)+" 条术语",1)]),n("div",fl,[n("div",bl,[t(a,{type:"text",onClick:T=>H(c)},{default:o(()=>e[10]||(e[10]=[v("编辑",-1)])),_:2,__:[10]},1032,["onClick"]),t(a,{type:"text",style:{color:"red"},onClick:T=>R(c)},{default:o(()=>e[11]||(e[11]=[v("删除",-1)])),_:2,__:[11]},1032,["onClick"]),t(a,{type:"text",onClick:T=>te(c),loading:z.value,disabled:z.value},{default:o(()=>[v(U(z.value?"导出中...":"导出"),1)]),_:2},1032,["onClick","loading","disabled"])]),n("div",yl,[t(r,{modelValue:c.share_flag,"onUpdate:modelValue":T=>c.share_flag=T,"active-value":"Y","inactive-value":"N",onChange:T=>C(c)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),c.sample_terms&&c.sample_terms.length>0?(f(),x("div",hl,[t(K,{data:c.sample_terms,style:{width:"100%"},"max-height":"340",border:"","header-cell-class-name":"table_title","tooltip-effect":"light"},{default:o(()=>[t(q,{prop:"original",label:c.origin_lang,"show-overflow-tooltip":""},null,8,["label"]),t(q,{prop:"comparison_text",label:c.target_lang,"show-overflow-tooltip":""},null,8,["label"])]),_:2},1032,["data"])])):(f(),x("div",xl,e[12]||(e[12]=[n("div",{class:"text"},"暂无术语数据",-1)])))])]),_:2},1024))),128))]),_:1})):(f(),x("div",wl,e[13]||(e[13]=[n("img",{src:ve,alt:""},null,-1),n("div",{class:"text"},"暂无数据",-1)])))])):W("",!0),b.value=="prompt"?(f(),x("div",kl,[E.value.length>0?(f(),I(Q,{key:0,gutter:24},{default:o(()=>[(f(!0),x(le,null,se(E.value,(c,A)=>(f(),I(O,{xs:24,sm:8,key:A},{default:o(()=>[n("div",Cl,[n("div",Vl,[n("div",{class:"t",title:c.title},U(c.title),9,$l)]),c.undelete?(f(),x("div",ql)):(f(),x("div",Tl,[n("div",Ul,[t(a,{type:"text",onClick:T=>j(c)},{default:o(()=>e[14]||(e[14]=[v("编辑",-1)])),_:2,__:[14]},1032,["onClick"]),t(a,{type:"text",style:{color:"red"},onClick:T=>re(c)},{default:o(()=>e[15]||(e[15]=[v("删除",-1)])),_:2,__:[15]},1032,["onClick"])]),n("div",Ll,[t(r,{modelValue:c.share_flag,"onUpdate:modelValue":T=>c.share_flag=T,"active-value":"Y","inactive-value":"N",onChange:T=>oe(c)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),n("div",Nl,[n("div",Rl,U(c.content),1)])])]),_:2},1024))),128))]),_:1})):(f(),x("div",Sl,e[16]||(e[16]=[n("img",{src:ve,alt:""},null,-1),n("div",{class:"text"},"暂无数据",-1)])))])):W("",!0)])),W("",!0)]),t(Ke,{ref_key:"termEditRef",ref:y,langs:Y,loading:m.value,onConfirm:G,onRefresh:$},null,8,["loading"]),t(tl,{ref_key:"promptEditRef",ref:V,loading:m.value,onConfirm:F},null,8,["loading"])])),[[ae,w.value]])}}},Yl=pe(El,[["__scopeId","data-v-3e07aa30"]]);export{Yl as default};
