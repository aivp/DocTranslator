import{_ as b,z as C,r as y,O as v,i as c,o as r,c as d,a,k as l,w as i,a3 as z,x as f,y as u,t as E,E as p,a5 as P}from"./index-CnQxGHSk.js";const A={class:"change-password-page"},B={class:"change-password-container"},N={class:"password-tips"},U={key:0,class:"el-icon-check"},Z={key:1,class:"el-icon-close"},q={key:0,class:"el-icon-check"},K={key:1,class:"el-icon-close"},O={key:0,class:"el-icon-check"},T={key:1,class:"el-icon-close"},$={__name:"reset",setup(j){const h=C(),m=y(),w=y(!1),s=v({oldpwd:"",newpwd:"",newpwd_confirmation:""}),k=v({oldpwd:[{required:!0,message:"请填写原密码",trigger:"blur"}],newpwd:[{validator:(_,e,o)=>{e?e.length<6?o(new Error("密码至少需要6位")):!/[a-zA-Z]/.test(e)||!/[0-9]/.test(e)?o(new Error("密码需包含字母和数字")):o():o(new Error("请填写新密码"))},trigger:"blur"}],newpwd_confirmation:[{required:!0,message:"请填写确认密码",trigger:"blur"}]}),g=async _=>{_.validate(async(e,o)=>{if(e){if(s.newpwd!==s.newpwd_confirmation){p.error("两次密码输入不一致");return}w.value=!0;try{const t=await P(s);t.code===200?(p.success("密码修改成功"),setTimeout(()=>{h.push({name:"login"})},1500)):p.error(t.message)}catch(t){p.error(t.message||"密码修改失败")}finally{w.value=!1}}else p.error(o[Object.keys(o)[0]][0].message)})};return(_,e)=>{const o=c("el-input"),t=c("el-form-item"),V=c("el-button"),x=c("el-form");return r(),d("div",A,[a("div",B,[e[8]||(e[8]=a("div",{class:"change-password-header"},[a("h1",{class:"change-password-title"},"修改密码"),a("p",{class:"change-password-subtitle"},"请填写以下信息以修改您的密码")],-1)),l(x,{ref_key:"form",ref:m,model:s,"show-message":!1,rules:k,onKeyup:e[4]||(e[4]=z(n=>g(m.value),["enter"]))},{default:i(()=>[l(t,{label:"",prop:"oldpwd"},{default:i(()=>[l(o,{modelValue:s.oldpwd,"onUpdate:modelValue":e[0]||(e[0]=n=>s.oldpwd=n),type:"password","show-password":"",placeholder:"原密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),l(t,{label:"",prop:"newpwd"},{default:i(()=>[l(o,{modelValue:s.newpwd,"onUpdate:modelValue":e[1]||(e[1]=n=>s.newpwd=n),type:"password","show-password":"",placeholder:"设置新密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"]),a("div",N,[a("div",{class:f(["tip-item",{valid:s.newpwd.length>=6}])},[s.newpwd.length>=6?(r(),d("i",U)):(r(),d("i",Z)),e[5]||(e[5]=u(" 至少6位字符 ",-1))],2),a("div",{class:f(["tip-item",{valid:/[a-zA-Z]/.test(s.newpwd)}])},[/[a-zA-Z]/.test(s.newpwd)?(r(),d("i",q)):(r(),d("i",K)),e[6]||(e[6]=u(" 包含字母 ",-1))],2),a("div",{class:f(["tip-item",{valid:/[0-9]/.test(s.newpwd)}])},[/[0-9]/.test(s.newpwd)?(r(),d("i",O)):(r(),d("i",T)),e[7]||(e[7]=u(" 包含数字 ",-1))],2)])]),_:1}),l(t,{label:"",prop:"newpwd_confirmation"},{default:i(()=>[l(o,{modelValue:s.newpwd_confirmation,"onUpdate:modelValue":e[2]||(e[2]=n=>s.newpwd_confirmation=n),type:"password","show-password":"",placeholder:"确认新密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),l(t,{label:"",class:"center"},{default:i(()=>[l(V,{type:"primary",size:"large",class:"change-password-btn",onClick:e[3]||(e[3]=n=>g(m.value)),loading:w.value},{default:i(()=>[u(E(w.value?"提交中...":"提交"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])])}}},L=b($,[["__scopeId","data-v-faacad55"]]);export{L as default};
